<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4. Communication Management &mdash; Adaptive Platform Training  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=248367c1" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Time Synchronization (TSync)" href="../tsync/tsync.html" />
    <link rel="prev" title="3. Overview of Function Clusters" href="../introduction/fc_overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Adaptive Platform Training
              <img src="../_static/avin_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/ap_introduction.html">1. <strong>Introduction to Software Defined Vehicle(SDVs)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/ap_introduction.html#introduction-of-autosar-adaptive-platform">2. <strong>Introduction of AUTOSAR Adaptive Platform</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/fc_overview.html">3. <strong>Overview of Function Clusters</strong></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. <strong>Communication Management</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">4.1. Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#architectural-concepts">4.1.1. Architectural concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#design-of-the-ara-api">4.1.2. Design of the ARA API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#communication-paradigms">4.1.2.1. Communication paradigms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#some-ip-scalable-service-oriented-middleware-over-ip">4.2. SOME/IP(Scalable service-Oriented MiddlewarE over IP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#on-wire-format">4.3. On-wire format</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#protocol">4.3.1. <strong>Protocol</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#some-ip-header-format">4.3.1.1. <strong>SOME/IP Header Format</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#serialization-of-data-structures">4.3.2. <strong>Serialization of Data Structures</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#some-ip-protocol-specification">4.3.3. <strong>SOME/IP Protocol specification</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#transport-protocol-bindings">4.3.3.1. <strong>Transport Protocol Bindings</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#service-discovery-some-ip-sd">4.4. Service Discovery(SOME/IP-SD)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#some-ip-sd-message-format">4.4.1. SOME/IP-SD Message Format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#some-ip-header">4.4.1.1. <strong>SOME/IP header</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#some-ip-sd-header">4.4.1.2. <strong>SOME/IP-SD Header</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#options-format">4.4.1.3. <strong>Options Format</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#service-entries">4.4.1.4. <strong>Service Entries</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#eventgroup-entry">4.4.1.5. Eventgroup Entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="#service-discovery-communication-behavior">4.4.1.6. <strong>Service Discovery Communication Behavior</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#generation-of-vsomeip-json">4.4.1.7. <strong>Generation of vsomeip.json</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ara-com-api">4.5. ARA Com API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#high-level-api-structure">4.5.1. High Level API Structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#proxy-skeleton-architecture">4.5.1.1. Proxy/Skeleton Architecture</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#data-type-abstractions">4.5.2. Data Type Abstractions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#error-notification">4.5.3. Error Notification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#checked-exceptions">4.5.3.1. Checked Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unchecked-exceptions">4.5.3.2. Unchecked Exceptions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#api-elements">4.6. API Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#common-types">4.6.1. Common Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#optional-data-elements">4.6.1.1. Optional data elements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#instance-identifiers">4.6.2. Instance Identifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#instance-specifier">4.6.3. Instance Specifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="#instance-identifier-container">4.6.4. Instance Identifier Container</a></li>
<li class="toctree-l3"><a class="reference internal" href="#proxy-class">4.6.5. Proxy Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constructor-and-handle-concept">4.6.6. Constructor and Handle Concept</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finding-services">4.6.7. Finding Services</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#auto-update-proxy-instance">4.6.7.1. Auto Update Proxy instance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#events">4.6.8. Events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#event-subscription-and-local-cache">4.6.8.1. Event Subscription and Local Cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="#monitoring-event-subscription">4.6.8.2. Monitoring Event Subscription</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessing-event-data-aka-samples">4.6.8.3. Accessing Event Data — aka Samples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#event-driven-vs-polling-based-access">4.6.8.4. Event-Driven vs Polling-Based access</a></li>
<li class="toctree-l4"><a class="reference internal" href="#buffering-strategies">4.6.8.5. Buffering Strategies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#methods">4.6.9. Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#one-way-or-fire-and-forget-methods">4.6.9.1. One-Way or Fire-and-Forget Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="#event-driven-vs-polling-access-to-method-results">4.6.9.2. Event-Driven vs Polling access to method results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#canceling-method-result">4.6.10. Canceling Method Result</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checked-exception-handling">4.6.11. Checked Exception Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fields">4.6.12. Fields</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#skeleton-class">4.7. Skeleton Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#instantiation">4.7.1. Instantiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#offering-service-instance">4.7.2. Offering Service instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#polling-and-event-driven-processing-modes">4.7.3. Polling and event-driven processing modes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#polling-mode">4.7.3.1. Polling Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#event-driven-mode">4.7.3.2. Event-Driven Mode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id1">4.7.4. Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#raising-application-errors">4.7.4.1. Raising Application Errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id2">4.7.5. Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">4.7.6. Fields</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#registering-getters">4.7.6.1. Registering Getters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#registering-setters">4.7.6.2. Registering Setters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#service-discovery-implementation-strategies">4.8. Service Discovery Implementation Strategies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#central-vs-distributed-approach">4.8.1. Central vs Distributed approach</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#central-approach">4.8.1.1. Central approach</a></li>
<li class="toctree-l4"><a class="reference internal" href="#distributed-approach">4.8.1.2. Distributed approach</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#multi-binding-implications">4.8.2. Multi-Binding implications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#simple-multi-binding-use-case">4.8.2.1. Simple Multi-Binding use case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#local-network-multi-binding-use-case">4.8.2.2. Local/Network Multi-Binding use case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#typical-some-ip-multi-binding-use-case">4.8.2.3. Typical SOME/IP Multi-Binding use case</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ara-com-and-autosar-meta-model-relationship">4.9. ara::com and AUTOSAR meta-model relationship</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#service-interface">4.9.1. Service Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="#software-component">4.9.2. Software Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adaptive-application-executables-and-processes">4.9.3. Adaptive Application/Executables and Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage-of-meta-model-identifiers-within-ara-com-based-application-code">4.9.4. Usage of meta-model identifiers within ara::com based application code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#serialization">4.10. Serialization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#zero-copy-implications">4.10.1. Zero-Copy implications</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ara-rest">4.11. ARA REST</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-rest">4.11.1. 1. What is REST ?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#key-properties-of-rest-api">4.11.1.1. Key Properties of REST API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ara-rest-architectural-elements">4.12. ARA::REST Architectural Elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-cases-door-ecu">4.13. Use cases: Door ECU</a></li>
<li class="toctree-l2"><a class="reference internal" href="#poco-library">4.14. POCO Library</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tsync/tsync.html">5. <strong>Time Synchronization (TSync)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../phm/phm.html">6. <strong>Platform Health Management(PHM)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../nm/nm.html">7. <strong>Network Management(NM)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ucm/ucm.html">8. <strong>Update and Configuration Management (UCM)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../sm/sm.html">9. <strong>State Management (SM)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../em/em.html">10. <strong>Execution Management (EM)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../persistency/persistency.html">11. <strong>Persistency</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/crypto.html">12. <strong>Cryptography</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../idsm/idsm.html">13. <strong>Intrusion Detection System Manager (IDSM)</strong></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Adaptive Platform Training</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">4. </span><strong>Communication Management</strong></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/com/com.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="communication-management">
<h1><span class="section-number">4. </span><strong>Communication Management</strong><a class="headerlink" href="#communication-management" title="Link to this heading"></a></h1>
<section id="introduction">
<h2><span class="section-number">4.1. </span>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>The AUTOSAR Adaptive architecture organizes the software of the AUTOSAR Adaptive foundation as functional clusters. These clusters offer common functionality as services to the applications. The Communication Management (CM) for AUTOSAR Adaptive is such a functional cluster and also part of “AUTOSAR Runtime for Adaptive Applications” - ARA. It is responsible for the construction and supervision of communication paths between applications, both local and remote. The CM provides the infrastructure that enables communication between Adaptive AUTOSAR Applications within one machine and with software entities on other machines, e.g. other Adaptive AUTOSAR applications or Classic AUTOSAR SWCs. All communication paths can be established at design- , start-up- or run-time.</p>
<figure class="align-center" id="id4">
<a class="with-border reference internal image-reference" href="../_images/Communication_Management_Functional_Cluster.png"><img alt="../_images/Communication_Management_Functional_Cluster.png" class="with-border" src="../_images/Communication_Management_Functional_Cluster.png" style="width: 748.0px; height: 472.0px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>Communication Management Functional Cluster</strong></span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="architectural-concepts">
<h3><span class="section-number">4.1.1. </span>Architectural concepts<a class="headerlink" href="#architectural-concepts" title="Link to this heading"></a></h3>
<p>The Communication management of AUTOSAR Adaptive can be logically divided into the following sub-parts:</p>
<blockquote>
<div><ul class="simple">
<li><p>Language binding</p></li>
<li><p>End-to-end communication protection</p></li>
<li><p>Communication / Network binding</p></li>
<li><p>Communication Management software</p></li>
</ul>
</div></blockquote>
</section>
<section id="design-of-the-ara-api">
<h3><span class="section-number">4.1.2. </span>Design of the ARA API<a class="headerlink" href="#design-of-the-ara-api" title="Link to this heading"></a></h3>
<p>The (service) proxy is the representative of the possibly remote (i.e. other process, other core, other node) service. It is an instance of a C++ class local to the application/client, which uses the service.</p>
<p>The (service) skeleton is the connection of the user provided service implementation to the middleware transport infrastructure. Service implementation is sub-classing the (service) skeleton.</p>
<p>Beside proxies/skeletons, there might exist a so-called “Runtime” (singleton) class to provide some essentials to manage proxies and skeletons.</p>
<p>Client/Server Communication uses concepts introduced by C++11 language, e.g. std::future, std::promise, to fully support method calls between different contexts. Future and Promise are the two separate sides of an asynchronous operation.</p>
<blockquote>
<div><ul class="simple">
<li><p>std::promise is used by the “producer/writer” of the asynchronous operation.</p></li>
<li><p>std::future is used by the “consumer/reader” of the asynchronous operation.</p></li>
<li><p>The reason it is separated into these two separate “interfaces” is to hide the “write/set” functionality from the “consumer/reader”</p></li>
</ul>
</div></blockquote>
<section id="communication-paradigms">
<h4><span class="section-number">4.1.2.1. </span>Communication paradigms<a class="headerlink" href="#communication-paradigms" title="Link to this heading"></a></h4>
<p>Service-Oriented Communication (SoC) is the main communication pattern for Adaptive AUTOSAR Applications. It allows establishing communication paths both at design- and run-time, so it can be used to build up both static communication with known numbers of participants and dynamic communication with unknown number of participants.</p>
<figure class="align-center" id="id5">
<img alt="../_images/Service_Oriented_Communication.png" class="with-border" src="../_images/Service_Oriented_Communication.png" />
<figcaption>
<p><span class="caption-text"><strong>Service-Oriented Communication</strong></span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Service Discovery decides whether external and/or internal service-oriented communication is established. The discovery strategy allows either returning a specific service instance or all available instances providing the requested service at the time of the request, no matter if they are available locally or remote.</p>
</section>
</section>
</section>
<section id="some-ip-scalable-service-oriented-middleware-over-ip">
<h2><span class="section-number">4.2. </span>SOME/IP(Scalable service-Oriented MiddlewarE over IP)<a class="headerlink" href="#some-ip-scalable-service-oriented-middleware-over-ip" title="Link to this heading"></a></h2>
<p>SOME/IP is an abbreviation for “Scalable service-Oriented MiddlewarE over IP”. This middleware was designed for typical automotive use cases and for being compatible with AUTOSAR. SOME/IP is an automotive/embedded communication protocol which supports remote procedure calls, event notifications and the underlying serialization/wire format.</p>
<p><strong>Glossary of Terms</strong></p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Term</strong></p></td>
<td><p><strong>Description</strong></p></td>
</tr>
<tr class="row-even"><td><p>Method</p></td>
<td><p>A method, procedure, function, or subroutine that is called/invoked.</p></td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><p>input, output, or input/output arguments of a method or an event</p></td>
</tr>
<tr class="row-even"><td><p>Remote
Procedure
Call (RPC)</p></td>
<td><p>A method call from one ECU to another that is transmitted using messages</p></td>
</tr>
<tr class="row-odd"><td><p>Request</p></td>
<td><p>a message of the client to the server invoking a method</p></td>
</tr>
<tr class="row-even"><td><p>Response</p></td>
<td><p>a message of the server to the client transporting results of a method invocation</p></td>
</tr>
<tr class="row-odd"><td><p>Request/
Response
communica
-tion</p></td>
<td><p>a RPC that consists of request and response</p></td>
</tr>
<tr class="row-even"><td><p>Event</p></td>
<td><p>A uni-directional data transmission that is only invoked on changes or cyclically
and is sent from the producer of data to the consumers.</p></td>
</tr>
<tr class="row-odd"><td><p>Field</p></td>
<td><p>A field does represent a status and thus has an valid value at all times
on which getter, setter and notifier act upon</p></td>
</tr>
<tr class="row-even"><td><p>Notificati-
on Event</p></td>
<td><p>An event message of the notifier of a field.</p></td>
</tr>
<tr class="row-odd"><td><p>Getter</p></td>
<td><p>A Request/Response call that allows read access to a field.</p></td>
</tr>
<tr class="row-even"><td><p>Setter</p></td>
<td><p>A Request/Response call that allows write access to a field.</p></td>
</tr>
<tr class="row-odd"><td><p>Notifier</p></td>
<td><p>Sends out event message with a new value on change of the value of the field.</p></td>
</tr>
<tr class="row-even"><td><p>Service</p></td>
<td><p>A logical combination of zero or more methods, zero or more events, and zero or
more fields.</p></td>
</tr>
<tr class="row-odd"><td><p>Service
Interface</p></td>
<td><p>the formal specification of the service including its methods, events, and fields.</p></td>
</tr>
<tr class="row-even"><td><p>Eventgroup</p></td>
<td><p>A logical grouping of events and notification events of fields inside a service in
order to allow subscription</p></td>
</tr>
<tr class="row-odd"><td><p>Service
Instance</p></td>
<td><p>Implementation of a service, which can exist more than once in the vehicle and
more than once on an ECU.</p></td>
</tr>
<tr class="row-even"><td><p>Server</p></td>
<td><p>The ECU offering a service instance is called server in the context of this
service instance.</p></td>
</tr>
<tr class="row-odd"><td><p>Client</p></td>
<td><p>The ECU using the service instance of a server is called client in the context of
this service instance.</p></td>
</tr>
<tr class="row-even"><td><p>Fire and
Forget</p></td>
<td><p>Requests without response message are called fire&amp;forget.</p></td>
</tr>
<tr class="row-odd"><td><p>Union</p></td>
<td><p>A data structure that dynamically assumes different data types.</p></td>
</tr>
</tbody>
</table>
<p>The three main parts of the SOME/IP specification is as follows:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>On-wire format</strong></p></li>
<li><p><strong>Protocol</strong></p></li>
<li><p><strong>Service Discovery(SOME/IP-SD)</strong></p></li>
</ul>
</div></blockquote>
</section>
<section id="on-wire-format">
<h2><span class="section-number">4.3. </span>On-wire format<a class="headerlink" href="#on-wire-format" title="Link to this heading"></a></h2>
<figure class="align-center" id="id6">
<img alt="../_images/SOMEIP_On_wire_format.png" class="with-border" src="../_images/SOMEIP_On_wire_format.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP On wire format</strong></span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>SOME/IP allows applications to communicate.</p></li>
<li><p>Packet formats are automatically determined by the specification of the Service.</p></li>
<li><p>Server offers a Service Instance that implements the Service Interface.</p></li>
<li><p>Client uses the Service Instance using SOME/IP.</p></li>
</ul>
<section id="protocol">
<h3><span class="section-number">4.3.1. </span><strong>Protocol</strong><a class="headerlink" href="#protocol" title="Link to this heading"></a></h3>
<section id="some-ip-header-format">
<h4><span class="section-number">4.3.1.1. </span><strong>SOME/IP Header Format</strong><a class="headerlink" href="#some-ip-header-format" title="Link to this heading"></a></h4>
<figure class="align-center" id="id7">
<img alt="../_images/SOMEIP_Header_Format.png" class="with-border" src="../_images/SOMEIP_Header_Format.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP Header Format</strong></span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="message-id-32-bit">
<h5><span class="section-number">4.3.1.1.1. </span><strong>Message ID [32 Bit]</strong><a class="headerlink" href="#message-id-32-bit" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The Message ID is a 32 Bit identifier that is used to identify the RPC call to a method of an application or to identify an event.</p></li>
<li><p>Message IDs of method calls will be structured in the ID with 2^16 services with 2^15 methods as shown below.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id8">
<img alt="../_images/Structure_Of_Message_ID.png" class="with-border" src="../_images/Structure_Of_Message_ID.png" />
<figcaption>
<p><span class="caption-text"><strong>Structure of Message ID</strong></span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="length-32-bit">
<h5><span class="section-number">4.3.1.1.2. </span><strong>Length [32 Bit]</strong><a class="headerlink" href="#length-32-bit" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>Length field contains the length in Byte starting from Request ID/Client ID until the end of the SOME/IP message.</p></li>
</ul>
</div></blockquote>
</section>
<section id="request-id-32-bit">
<h5><span class="section-number">4.3.1.1.3. </span><strong>Request ID [32 Bit]</strong><a class="headerlink" href="#request-id-32-bit" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The Request ID allows a provider and subscriber to differentiate multiple parallel uses of the same method, event, getter or setter.</p></li>
<li><p>The Request ID is unique for a provider- and subscriber-combination only.</p></li>
<li><p>When generating a response message, the provider copies the Request ID from the request to the response message.</p></li>
<li><p>Request ID constructed of the Client ID and Session ID as shown below.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id9">
<img alt="../_images/Structure_Of_Request_ID.png" class="with-border" src="../_images/Structure_Of_Request_ID.png" />
<figcaption>
<p><span class="caption-text"><strong>Structure of Request ID</strong></span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>The Client ID is the unique identifier for the calling client inside the ECU. The Client ID allows an ECU to differentiate calls from multiple clients to the same method.</p></li>
<li><p>The Session ID is a unique identifier that allows to distinguish sequential messages. It also allows to distinguish requests originating from the same sender from each other.</p></li>
<li><p>The Client ID supports being unique in the overall vehicle by having a configurable prefix or fixed value (e.g. the most significant byte of Client ID being the diagnostics address or a configured Client ID for a given application/SW-C).</p></li>
</ul>
<figure class="align-center" id="id10">
<img alt="../_images/Structure_Of_Client_ID.png" class="with-border" src="../_images/Structure_Of_Client_ID.png" />
<figcaption>
<p><span class="caption-text"><strong>Structure of Client ID</strong></span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Request/Response methods use session handling with Session IDs. Session ID should be incremented after each call.</p></li>
<li><p>When the Session ID reaches 0xFFFF, it wraps around and starts again with 0x01.</p></li>
<li><p>For request/response methods, a subscriber has to ignore a response if the Session ID of the response does not match the Session ID of the request.</p></li>
<li><p>For notification messages, a receiver ignores the Session ID in case Session Handling is not active.</p></li>
<li><p>For notification messages, a receiver treats the Session ID according to the respective use case.</p></li>
</ul>
</section>
<section id="protocol-version-8-bit">
<h5><span class="section-number">4.3.1.1.4. </span><strong>Protocol Version [8 Bit]</strong><a class="headerlink" href="#protocol-version-8-bit" title="Link to this heading"></a></h5>
<p>The Protocol Version set to 1.</p>
</section>
<section id="interface-version-8-bit">
<h5><span class="section-number">4.3.1.1.5. </span><strong>Interface Version [8 Bit]</strong><a class="headerlink" href="#interface-version-8-bit" title="Link to this heading"></a></h5>
<p>Interface Version contains the Major Version of the Service Interface.</p>
</section>
<section id="message-type-8-bit">
<h5><span class="section-number">4.3.1.1.6. </span><strong>Message Type [8 Bit]</strong><a class="headerlink" href="#message-type-8-bit" title="Link to this heading"></a></h5>
<p>The Message Type field is used to differentiate different types of messages and contains the following values as shown in Table.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Number</strong></p></td>
<td><p><strong>Value</strong></p></td>
<td><p><strong>Description</strong></p></td>
</tr>
<tr class="row-even"><td><p>0x00</p></td>
<td><p>REQUEST</p></td>
<td><p>A request expecting a response (even void)</p></td>
</tr>
<tr class="row-odd"><td><p>0x01</p></td>
<td><p>REQUEST_NO
_RETURN</p></td>
<td><p>A fire&amp;forget request</p></td>
</tr>
<tr class="row-even"><td><p>0x02</p></td>
<td><p>NOTIFICATION</p></td>
<td><p>A request of a notification/event callback expecting response</p></td>
</tr>
<tr class="row-odd"><td><p>0x80</p></td>
<td><p>RESPONSE</p></td>
<td><p>The response message</p></td>
</tr>
<tr class="row-even"><td><p>0x81</p></td>
<td><p>ERROR</p></td>
<td><p>The response containing an error</p></td>
</tr>
<tr class="row-odd"><td><p>0x20</p></td>
<td><p>TP_REQUEST</p></td>
<td><p>A Transport Protocol request expecting a response (even void)</p></td>
</tr>
<tr class="row-even"><td><p>0x21</p></td>
<td><p>TP_REQUEST
_NO_RETURN</p></td>
<td><p>A Transport Protocol fire&amp;forget request</p></td>
</tr>
<tr class="row-odd"><td><p>0x22</p></td>
<td><p>TP_NOTIFICA
TION</p></td>
<td><p>A Transport Protocol request of a notification/event callback expecting no response</p></td>
</tr>
<tr class="row-even"><td><p>0x23</p></td>
<td><p>TP_RESPONSE</p></td>
<td><p>The Transport Protocol response message</p></td>
</tr>
<tr class="row-odd"><td><p>0x24</p></td>
<td><p>TP_ERROR</p></td>
<td><p>The Transport Protocol response containing an error</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><ul class="simple">
<li><p>The 3rd highest bit of the Message Type (=0x20) is called as TP-Flag and will be set to 1 to signal that the current SOME/IP message is a segment. The other bits of the Message Type are set as specified in this Section.</p></li>
</ul>
</div></blockquote>
</section>
<section id="return-code-8-bit">
<h5><span class="section-number">4.3.1.1.7. </span><strong>Return Code [8 Bit]</strong><a class="headerlink" href="#return-code-8-bit" title="Link to this heading"></a></h5>
<p>The Return Code is used to signal whether a request was successfully processed. For simplification of the header layout, every message transports the field Return Code. The allowed Return Codes for specific message types are shown in Table.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Message Type</strong></p></td>
<td><p><strong>ERROR</strong></p></td>
</tr>
<tr class="row-even"><td><p>REQUEST</p></td>
<td><p>N/A set to 0x00 (E_OK)</p></td>
</tr>
<tr class="row-odd"><td><p>REQUEST_NO_RETURN</p></td>
<td><p>N/A set to 0x00 (E_OK)</p></td>
</tr>
<tr class="row-even"><td><p>NOTIFICATION</p></td>
<td><p>N/A set to 0x00 (E_OK)</p></td>
</tr>
<tr class="row-odd"><td><p>RESPONSE</p></td>
<td><p>Please refer 2.2.6.1 section</p></td>
</tr>
<tr class="row-even"><td><p>ERROR</p></td>
<td><p>Please refer 2.2.6.1 section</p></td>
</tr>
</tbody>
</table>
</section>
<section id="payload-variable-size">
<h5><span class="section-number">4.3.1.1.8. </span><strong>Payload [variable size]</strong><a class="headerlink" href="#payload-variable-size" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>In the payload field the parameters are carried. The serialization of the parameters will be specified in the following section.</p></li>
<li><p>The size of the SOME/IP payload field depends on the transport protocol used.</p></li>
<li><p>The UDP binding of SOME/IP can only transport SOME/IP messages that fit directly into an IP packet. Use TCP only if very large chunks of data need to be transported (&gt; 1400 Bytes) and no hard latency requirements in the case of errors exists</p></li>
</ul>
</div></blockquote>
</section>
<section id="event-field-and-eventgroup">
<h5><span class="section-number">4.3.1.1.9. </span><strong>Event, Field and Eventgroup</strong><a class="headerlink" href="#event-field-and-eventgroup" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>Eventgroup is a logical grouping of events and notification events of fields inside a service in order to allow subscription.</p></li>
<li><p>Events and notifications are transported using RPC. Events will be structured as shown in Table</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id11">
<img alt="../_images/Structuure_of_event_ID.png" class="with-border" src="../_images/Structuure_of_event_ID.png" />
<figcaption>
<p><span class="caption-text"><strong>Structuure of event ID</strong></span><a class="headerlink" href="#id11" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="endianess">
<h5><span class="section-number">4.3.1.1.10. </span><strong>Endianess</strong><a class="headerlink" href="#endianess" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>SOME/IP Header will be encoded in network byte order (big endian).</p></li>
<li><p>The byte order of the parameters inside the payload is defined by configuration.</p></li>
</ul>
</section>
</section>
</section>
<section id="serialization-of-data-structures">
<h3><span class="section-number">4.3.2. </span><strong>Serialization of Data Structures</strong><a class="headerlink" href="#serialization-of-data-structures" title="Link to this heading"></a></h3>
<blockquote>
<div><ul class="simple">
<li><p>The serialization is based on the parameter list defined by the interface specification. The interface specification defines the exact position of all data structures in the PDU and has to consider the memory alignment.</p></li>
<li><p>Alignment is used to align the beginning of data by inserting padding elements after the data in order to ensure that the aligned data starts at certain memory addresses</p></li>
</ul>
</div></blockquote>
</section>
<section id="some-ip-protocol-specification">
<h3><span class="section-number">4.3.3. </span><strong>SOME/IP Protocol specification</strong><a class="headerlink" href="#some-ip-protocol-specification" title="Link to this heading"></a></h3>
<p>This section describes the Remote Procedure Call(RPC), Event Notifications and Error Handling of SOME/IP.</p>
<section id="transport-protocol-bindings">
<h4><span class="section-number">4.3.3.1. </span><strong>Transport Protocol Bindings</strong><a class="headerlink" href="#transport-protocol-bindings" title="Link to this heading"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>In order to transport SOME/IP messages different transport protocols may be used. SOME/IP currently supports UDP and TCP.</p></li>
<li><p>If a server runs different instances of the same service, messages belonging to different service instances will be mapped to the service instance by the transport protocol port on the server side.</p></li>
<li><p>All Transport Protocol Bindings supports transporting more than one SOME/IP message in a Transport Layer PDU (i.e. UDP packet or TCP segment).</p></li>
</ul>
</div></blockquote>
<section id="udp-binding">
<h5><span class="section-number">4.3.3.1.1. </span><strong>UDP Binding</strong><a class="headerlink" href="#udp-binding" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The UDP binding of SOME/IP will be achieved by transporting SOME/IP messages in UDP packets.</p></li>
<li><p>The header format allows transporting more than one SOME/IP message in a single UDP packet. The SOME/IP implementation identifies the end of a SOME/IP message by means of the SOME/IP length field. Based on the UDP length field, SOME/IP determines if there are additional SOME/IP messages in the UDP packet.</p></li>
</ul>
</div></blockquote>
</section>
<section id="tcp-binding">
<h5><span class="section-number">4.3.3.1.2. </span><strong>TCP Binding</strong><a class="headerlink" href="#tcp-binding" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The TCP binding of SOME/IP is based on the UDP binding. In contrast to the UDP binding, the TCP binding allows much bigger SOME/IP messages and uses the robustness features of TCP (coping with loss, reorder, duplication, etc.).</p></li>
<li><p>When the TCP connection is lost, outstanding requests will be handled as timeouts. Since TCP handles reliability, additional means of reliability are not needed.</p></li>
<li><p>The client and server uses a single TCP connection for all methods, events, and notifications of a service instance. When having more than one instance of a service a TCP connection per services instance is needed.</p></li>
<li><p>The TCP connection will be opened by the client, when the first method call will be transported or the client tries to receive the first notifications. The client is responsible for re-establishing the TCP connection whenever it fails.</p></li>
<li><p>The TCP connection will be closed by the client, when the TCP connection is not required anymore.</p></li>
<li><p>The TCP connection will be closed by the client, when all Services using the TCP connections are not available anymore (stopped or timed out).</p></li>
<li><p>The server will not stop the TCP connection when stopping all services. Give the client enough time to process the control data to shutdown the TCP connection itself.</p></li>
</ul>
</div></blockquote>
</section>
<section id="multiple-service-instances">
<h5><span class="section-number">4.3.3.1.3. </span><strong>Multiple Service-Instances</strong><a class="headerlink" href="#multiple-service-instances" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>Service-Instances of the same Service are identified through different Instance IDs. SOME/IP supports multiple Service-Instances reside on different ECUs as well as multiple Service-Instances of one or more Services reside on one single ECU.</p></li>
<li><p>While different Services will be able to share the same port number of the transport layer protocol used, multiple Service-Instances of the same service on one single ECU listens on different ports per Service-Instance.</p></li>
<li><p>A Service Instance can be identified through the combination of the Service ID combined with the socket (i.e. IP-address, transport protocol (UDP/TCP), and port number).</p></li>
</ul>
</div></blockquote>
</section>
<section id="transporting-large-some-ip-messages-of-udp-some-ip-tp">
<h5><span class="section-number">4.3.3.1.4. </span><strong>Transporting large SOME/IP messages of UDP (SOME/IP-TP)</strong><a class="headerlink" href="#transporting-large-some-ip-messages-of-udp-some-ip-tp" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The UDP binding of SOME/IP can only transport SOME/IP messages that fit directly into an IP packet. If larger SOME/IP messages need to be transported over UDP (e.g. of 32 KB) the SOME/IP Transport Protocol (SOME/IP-TP) will be used. The SOME/IP message too big to be transported directly with the UDP binding will be called “original” SOME/IP message. The “pieces” of the original SOME/IP message payload transported in SOME/IP-TP messages will be called “segments”.</p></li>
<li><p>SOME/IP messages using SOME/IP-TP activates Session Handling (Session ID must be unique for the original message).</p></li>
<li><p>All SOME/IP-TP segments carry the Session ID of the original message; thus, they have all the same Session-ID.</p></li>
<li><p>SOME/IP-TP segments will have the TP-Flag of the Message Type set to 1.</p></li>
<li><p>SOME-IP-TP-Header is as shown in below. SOME/IP-TP segments will have a TP header right after the SOME/IP header (i.e. before the SOME/IP payload) with the following structure (bits from highest to lowest):</p></li>
</ul>
</div></blockquote>
<p><strong>a. Offset [28 bits]</strong></p>
<p><strong>b. Reserved Flag [1 bit]</strong></p>
<p><strong>c. Reserved Flag [1 bit]</strong></p>
<p><strong>d. Reserved Flag [1 bit]</strong></p>
<p><strong>e. More Segments Flag [1 bit]</strong></p>
<figure class="align-center" id="id12">
<img alt="../_images/someip_tp_header.png" class="with-border" src="../_images/someip_tp_header.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP TP header</strong></span><a class="headerlink" href="#id12" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="example">
<h5><span class="section-number">4.3.3.1.5. </span><strong>Example</strong><a class="headerlink" href="#example" title="Link to this heading"></a></h5>
<p>This example describes how an original SOME/IP message of 5880 bytes payload has to be transmitted. The Length field of this original SOME/IP message is set to 8 + 5880 bytes.</p>
<figure class="align-center" id="id13">
<img alt="../_images/header_of_original_SomeIp_Message.png" class="with-border" src="../_images/header_of_original_SomeIp_Message.png" />
<figcaption>
<p><span class="caption-text"><strong>Example: Header of Original SOME/IP message</strong></span><a class="headerlink" href="#id13" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>This original SOME/IP message will now be segmented into 5 consecutive SOME/IP segments. Every payload of these segments carries at most 1392 bytes in this example.</p></li>
<li><p>For these segments, the SOME/IP TP module adds additional TP fields. The Length field of the SOME/IP carries the overall length of the SOME/IP segment including 8 bytes for the Request ID, Protocol Version, Interface Version, Message Type and Return Code. Because of the added TP fields (4 bytes), this Length information is extended by 4 additional SOME/IP TP bytes.</p></li>
</ul>
<p>The following figure provides an overview of the relevant SOME/IP header settings for every SOME/IP segment.</p>
<figure class="align-center" id="id14">
<img alt="../_images/overview_of_relevant_someip_TP_headers.png" class="with-border" src="../_images/overview_of_relevant_someip_TP_headers.png" />
<figcaption>
<p><span class="caption-text"><strong>Example: Overview of relevant SOME/IP TP headers</strong></span><a class="headerlink" href="#id14" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Please note that the value provided within the Offset Field is given in units of 16 bytes, i.e.: The Offset Value of 87 correspond to 1392 bytes Payload.</p></li>
<li><p>The first 4 segments contain 1392 Payload bytes each with “More Segments Flag” set to ’1’:</p></li>
</ul>
<figure class="align-center" id="id15">
<img alt="../_images/Header_of_the_someip_segment.png" class="with-border" src="../_images/Header_of_the_someip_segment.png" />
<figcaption>
<p><span class="caption-text"><strong>Example: Header of the SOME/IP segments</strong></span><a class="headerlink" href="#id15" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>The last segment (i.e. 5) contains the remaining 312 Payload bytes of the original 5880 bytes payload. This last segment is marked with “More Segments flag” set to ’0’.</p></li>
</ul>
<figure class="align-center" id="id16">
<img alt="../_images/someip_segments.png" class="with-border" src="../_images/someip_segments.png" />
<figcaption>
<p><span class="caption-text"><strong>Example: Header of the SOME/IP segments</strong></span><a class="headerlink" href="#id16" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
</section>
</section>
<section id="service-discovery-some-ip-sd">
<h2><span class="section-number">4.4. </span>Service Discovery(SOME/IP-SD)<a class="headerlink" href="#service-discovery-some-ip-sd" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>SOME/IP-SD is used to</dt><dd><ul class="simple">
<li><p>Locate service instances.</p></li>
<li><p>Detect if service instances are running.</p></li>
<li><p>Implement the Publish/Subscribe handling.</p></li>
</ul>
</dd>
</dl>
<p>SOME/IP-SD depends on SOME/IP. SOME/IP itself supports both TCP and UDP communications but SOME/IP SD uses SOME/IP only over UDP .</p>
<figure class="align-center" id="id17">
<img alt="../_images/dependancy_someipsd.png" class="with-border" src="../_images/dependancy_someipsd.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD Dependencies to other protocol layers</strong></span><a class="headerlink" href="#id17" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="some-ip-sd-message-format">
<h3><span class="section-number">4.4.1. </span>SOME/IP-SD Message Format<a class="headerlink" href="#some-ip-sd-message-format" title="Link to this heading"></a></h3>
<figure class="align-center" id="id18">
<img alt="../_images/someipsd_header.png" class="with-border" src="../_images/someipsd_header.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD Header Format</strong></span><a class="headerlink" href="#id18" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>We can divide the above mention figure into two parts.</p>
<section id="some-ip-header">
<h4><span class="section-number">4.4.1.1. </span><strong>SOME/IP header</strong><a class="headerlink" href="#some-ip-header" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Field</strong></p></td>
<td><p><strong>Description(Default Value)</strong></p></td>
</tr>
<tr class="row-even"><td><p>Service-ID(16 bits)</p></td>
<td><p>0xFFFF</p></td>
</tr>
<tr class="row-odd"><td><p>Method-ID(16 bits)</p></td>
<td><p>0x8100</p></td>
</tr>
<tr class="row-even"><td><p>length(32 bits)</p></td>
<td><p>length is measured in bytes and starts with the first byte after the length field and
ends with the last byte of the SOME/IP-SD message.</p></td>
</tr>
<tr class="row-odd"><td><p>Client-ID(16 bits)</p></td>
<td><p>Set to 0x0000</p></td>
</tr>
<tr class="row-even"><td><p>Session-ID (16 Bits)</p></td>
<td><p>The Session-ID (SOME/IP header) will be incremented for every SOME/IP-SD message sent.
The Session-ID (SOME/IP header) starts with 1 and be 1 even after wrapping.</p></td>
</tr>
<tr class="row-odd"><td><p>Protocol- Version
(8 Bits)</p></td>
<td><p>0x01</p></td>
</tr>
<tr class="row-even"><td><p>Interface- Version
(8 Bits)</p></td>
<td><p>0x01</p></td>
</tr>
<tr class="row-odd"><td><p>Message Type (8 bits)</p></td>
<td><p>0x02 (Notification)</p></td>
</tr>
<tr class="row-even"><td><p>Return Code(8 bits)</p></td>
<td><p>Return Code(8 bits)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="some-ip-sd-header">
<h4><span class="section-number">4.4.1.2. </span><strong>SOME/IP-SD Header</strong><a class="headerlink" href="#some-ip-sd-header" title="Link to this heading"></a></h4>
<figure class="align-center" id="id19">
<img alt="../_images/someip_sd_pdu.png" class="with-border" src="../_images/someip_sd_pdu.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD Example PDU</strong></span><a class="headerlink" href="#id19" title="Link to this image"></a></p>
<div class="legend">
<blockquote>
<div><ul class="simple">
<li><p>The SOME/IP-SD Header starts with an 8 Bit field called Flags as shown in the Figure below.</p></li>
</ul>
</div></blockquote>
</div>
</figcaption>
</figure>
<figure class="align-center" id="id20">
<img alt="../_images/someipsd_flags.png" class="with-border" src="../_images/someipsd_flags.png" />
<figcaption>
<p><span class="caption-text"><strong>Flags in SOME/IP-SD</strong></span><a class="headerlink" href="#id20" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>The Reboot Flag of the SOME/IP-SD Header is set to 1 for all messages after reboot until the Session-ID in the SOME/IP-Header wraps around and thus starts with 1 again. After this wrap around the Reboot Flag is set to 0.</p></li>
<li><p>The information for the reboot flag and the Session ID will be kept for multicast, unicast and every sender-receiver relation (i.e. source address and destination address) separately.</p></li>
<li><p>This means there will be separate counters for sending and receiving.</p></li>
</ul>
<p><strong>Sending</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>There will be a counter for multicast.</p></li>
<li><p>There will be a separate counter for each peer for unicast.</p></li>
</ul>
</div></blockquote>
<p><strong>Receiving</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>There will be a counter for each peer for multicast.</p></li>
<li><p>There will be a counter for each peer for unicast.</p></li>
</ul>
</div></blockquote>
<p>The Unicast Flag of the SOME/IP-SD Header is set to Unicast (that means 1) for all SD Messages since this means that receiving using unicast is supported.</p>
<p>The third flag of the SOME/IP-SD Flags (third highest order bit) will be called Explicit Initial Data Control Flag and means that the ECU supports explicit initial data control.</p>
<p>After the SOME/IP-SD Header the Entries Array follows. The entries will be processed exactly in the order they arrive.</p>
<p>After the Entries Array in the SOME/IP-SD Header an Option Array will follow.</p>
<section id="entry-format">
<h5><span class="section-number">4.4.1.2.1. </span><strong>Entry Format</strong><a class="headerlink" href="#entry-format" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The service discovery supports multiple entries that are combined in one service discovery message. The entries are used to synchronize the state of services instances and the Publish/Subscribe handling.</p></li>
<li><p>Two types of entries exist: A Service Entry Type for Services and an Eventgroup Entry Type for Eventgroups.</p></li>
</ul>
</div></blockquote>
</section>
<section id="service-entry-type-for-services">
<h5><span class="section-number">4.4.1.2.2. </span><strong>Service Entry Type for Services</strong><a class="headerlink" href="#service-entry-type-for-services" title="Link to this heading"></a></h5>
<figure class="align-center" id="id21">
<img alt="../_images/someip_sd_serviceentry.png" class="with-border" src="../_images/someip_sd_serviceentry.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD Service Entry Type</strong></span><a class="headerlink" href="#id21" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Type Field [uint8]: encodes FindService (0x00) and OfferService (0x01).</p></li>
<li><p>Index First Option Run [uint8]: Index of this runs first option in the option array.</p></li>
<li><p>Index Second Option Run [uint8]: Index of this runs second option in the option array.</p></li>
<li><p>Number of Options 1 [uint4]: Describes the number of options the first option run uses.</p></li>
<li><p>Number of Options 2 [uint4]: Describes the number of options the second option run uses.</p></li>
<li><p>Service-ID [uint16]: Describes the Service ID of the Service or Service-Instance this entry is concerned with.</p></li>
<li><p>Instance ID [uint16]: Describes the Service Instance ID of the Service Instance this entry is concerned with or is set to 0xFFFF if all service instances of a service are meant.</p></li>
<li><p>Major Version [uint8]: Encodes the major version of the service (instance).</p></li>
<li><p>TTL [uint24]: Describes the lifetime of the entry in seconds.</p></li>
<li><p>Minor Version [uint32]: Encodes the minor version of the service.</p></li>
</ul>
</section>
<section id="eventgroup-entry-type-for-eventgroups">
<h5><span class="section-number">4.4.1.2.3. </span>Eventgroup Entry Type for Eventgroups<a class="headerlink" href="#eventgroup-entry-type-for-eventgroups" title="Link to this heading"></a></h5>
<figure class="align-center" id="id22">
<img alt="../_images/someip_sd_eventgroupentry.png" class="with-border" src="../_images/someip_sd_eventgroupentry.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD Eventgroup Entry Type</strong></span><a class="headerlink" href="#id22" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Type Field [uint8]: encodes Subscribe (0x06), and SubscribeAck (0x07).</p></li>
<li><p>Index First Option Run [uint8]: Index of this runs first option in the option array.</p></li>
<li><p>Index Second Option Run [uint8]: Index of this runs second option in the option array.</p></li>
<li><p>Number of Options 1 [uint4]: Describes the number of options the first option run uses.</p></li>
<li><p>Number of Options 2 [uint4]: Describes the number of options the second option run uses.</p></li>
<li><p>Service-ID [uint16]: Describes the Service ID of the Service or Service Instance this entry is concerned with.</p></li>
<li><p>Instance ID [uint16]: Describes the Service Instance ID of the Service Instance this entry is concerned with or is set to 0xFFFF if all service instances of a service are meant.</p></li>
<li><p>Major Version [uint8]: Encodes the major version of the service instance this eventgroup is part of.</p></li>
<li><p>TTL [uint24]: Descibes the lifetime of the entry in seconds.</p></li>
<li><p>Reserved [uint8]: Set to 0x00.</p></li>
<li><p>Initial Data Requested Flag [1 bit] (I Flag): Set to 1, if initial data will sent by Server</p></li>
<li><p>Reserved2 [uint3]: Set to 0x0.</p></li>
<li><p>Counter [uint4]: Is used to differentiate identical Subscribe Eventgroups of the same subscriber. Set to 0x0 if not used.</p></li>
<li><p>Eventgroup ID [uint16]: Transports the ID of an Eventgroup.</p></li>
</ul>
</section>
<section id="referencing-options-from-entries">
<h5><span class="section-number">4.4.1.2.4. </span>Referencing Options from Entries<a class="headerlink" href="#referencing-options-from-entries" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>Index First Option Run: Index into array of options for first option run. Index 0 means first of SOME/IP-SD packet.</p></li>
<li><p>Index Second Option Run: Index into array of options for second option run. Index 0 means first of SOME/IP-SD packet.</p></li>
<li><p>Number of Options 1: Length of first option run. Length 0 means no option in option run.</p></li>
<li><p>Number of Options 2: Length of second option run. Length 0 means no option in option run.</p></li>
<li><p>Two different option runs exist: First Option Run and Second Option Run. Two different types of options are expected: options common between multiple SOME/IP-SD entries and options different for each SOME/IP-SD entry. Supporting to different options runs is the most efficient way to support these two types of options, while keeping the wire format highly efficient.</p></li>
<li><p>Each option run will reference the first option and the number of options for this run.</p></li>
<li><p>If the number of options is set to zero, the option run is considered empty.</p></li>
<li><p>For empty runs the Index (i.e. Index First Option Run and/or Index Second Option Run) will set to zero.</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="options-format">
<h4><span class="section-number">4.4.1.3. </span><strong>Options Format</strong><a class="headerlink" href="#options-format" title="Link to this heading"></a></h4>
<p>Options are used to transport additional information to the entries. This includes for instance the information how a service instance is reachable (IP-Address, Transport Protocol, Port Number.</p>
<p>In order to identify the option type every option starts with:</p>
<blockquote>
<div><ul class="simple">
<li><p>Length [uint16]: Specifies the length of the option in Bytes.</p></li>
<li><p>Type [uint8]: Specifying the type of the option.</p></li>
</ul>
</div></blockquote>
<p>The length field covers all bytes of the option except the length field and type field.</p>
<section id="configuration-option">
<h5><span class="section-number">4.4.1.3.1. </span><strong>Configuration Option</strong><a class="headerlink" href="#configuration-option" title="Link to this heading"></a></h5>
<p>The configuration option is used to transport arbitrary configuration strings. This allows to encode additional information like the name of a service or its configuration.</p>
<figure class="align-center" id="id23">
<img alt="../_images/SOMEIPSDConfigurationOption.png" class="with-border" src="../_images/SOMEIPSDConfigurationOption.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD Configuration Option</strong></span><a class="headerlink" href="#id23" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="load-balancing-option">
<h5><span class="section-number">4.4.1.3.2. </span><strong>Load Balancing Option</strong><a class="headerlink" href="#load-balancing-option" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The Load Balancing option is used to prioritize different instances of a service, so that a client chooses the service instance based on these settings. This option will be attached to Offer Service entries.</p></li>
<li><p>The Load Balancing Option carry a Priority and Weight, which is used for load balancing different service instances.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id24">
<img alt="../_images/SOMEIPSDLoadBalancingOption.png" class="with-border" src="../_images/SOMEIPSDLoadBalancingOption.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD Load Balancing Option</strong></span><a class="headerlink" href="#id24" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="ipv4-endpoint-option">
<h5><span class="section-number">4.4.1.3.3. </span><strong>IPv4 Endpoint Option</strong><a class="headerlink" href="#ipv4-endpoint-option" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The IPv4 Endpoint Option is used by a SOME/IP-SD instance to signal the relevant endpoint(s).</p></li>
<li><p>Endpoints include the local IP address, the transport layer protocol (e.g. UDP or TCP), and the port number of the sender.</p></li>
<li><p>These ports are used for the events and notification events as well.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id25">
<img alt="../_images/SOMEIPSDIPv4EndpointOption.png" class="with-border" src="../_images/SOMEIPSDIPv4EndpointOption.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD IPv6 Endpoint Option</strong></span><a class="headerlink" href="#id25" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This option is used by the server for its OfferService entry and by client for Subscribe Eventgroup entry.</p>
</section>
<section id="ipv6-endpoint-option">
<h5><span class="section-number">4.4.1.3.4. </span><strong>IPv6 Endpoint Option</strong><a class="headerlink" href="#ipv6-endpoint-option" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The IPv6 Endpoint Option is used by a SOME/IP-SD instance to signal the relevant endpoint(s).</p></li>
<li><p>Endpoints include the local IP address, the transport layer protocol (e.g. UDP or TCP), and the port number of the sender.ports are used for the events and notification events as well.</p></li>
<li><p>This option is used by the server for its OfferService entry and by client for Subscribe Eventgroup entry.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id26">
<img alt="../_images/SOMEIPSDIPv6EndpointOption.png" class="with-border" src="../_images/SOMEIPSDIPv6EndpointOption.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD IPv6 Endpoint Option</strong></span><a class="headerlink" href="#id26" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="ipv4-multicast-option">
<h5><span class="section-number">4.4.1.3.5. </span><strong>IPv4 Multicast Option</strong><a class="headerlink" href="#ipv4-multicast-option" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The IPv4 Multicast Option is used by the server to announce the IPv4 multicast address, the transport layer protocol (ISO/OSI layer 4), and the port number the multicast events and multicast notification events are sent to.</p></li>
<li><p>As transport layer protocol currently only UDP is supported.</p></li>
<li><p>The IPv4 Multicast Option is referenced by Subscribe Eventgroup Ack entries.</p></li>
<li><p>The server reference the IPv4 Multicast Option, which encodes the IPv4 Multicast Address and Port Number the server will send multicast events and notification events to.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id27">
<img alt="../_images/SOMEIPSDIPv4MulticastOption.png" class="with-border" src="../_images/SOMEIPSDIPv4MulticastOption.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD IPv4 Multicast Option</strong></span><a class="headerlink" href="#id27" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="ipv6-multicast-option">
<h5><span class="section-number">4.4.1.3.6. </span><strong>IPv6 Multicast Option</strong><a class="headerlink" href="#ipv6-multicast-option" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The IPv6 Multicast Option is used by the server to announce the IPv6 multicast address, the layer 4 protocol, and the port number the multicast events and multicast notifications events are sent to.</p></li>
<li><p>For the transport layer protocol (ISO/OSI layer 4) currently only UDP is supported.</p></li>
<li><p>The IPv6 Multicast Option, referenced by Subscribe Eventgroup Ack messages.</p></li>
<li><p>The server references the IPv6 Multicast Option, which encodes the IPv6 Multicast Address and Port Number the server will send multicast events and notification events to.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id28">
<img alt="../_images/SOMEIPSDIPv6MulticastOption.png" class="with-border" src="../_images/SOMEIPSDIPv6MulticastOption.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD IPv6 Multicast Option</strong></span><a class="headerlink" href="#id28" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="ipv4-sd-endpoint-option">
<h5><span class="section-number">4.4.1.3.7. </span><strong>IPv4 SD Endpoint Option</strong><a class="headerlink" href="#ipv4-sd-endpoint-option" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The IPv4 SD Endpoint Option is used to transport the endpoint (i.e. IP-Address and Port) of the senders SD implementation.</p></li>
<li><p>This is used to identify the SOME/IP-SD Instance even in cases in which the IP-Address and/or Port Number cannot be used.</p></li>
<li><p>A use case would be a proxy service discovery on one ECU which handles the multicast traffic for another ECU.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id29">
<img alt="../_images/SOMEIPSDIPv4SDEndpointOption.png" class="with-border" src="../_images/SOMEIPSDIPv4SDEndpointOption.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD IPv4 SD Endpoint Option</strong></span><a class="headerlink" href="#id29" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="ipv6-sd-endpoint-option">
<h5><span class="section-number">4.4.1.3.8. </span><strong>IPv6 SD Endpoint Option</strong><a class="headerlink" href="#ipv6-sd-endpoint-option" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The Ipv6 SD Endpoint Option is used to transport the endpoint (i.e. IP-Address and Port) of the senders SD implementation.</p></li>
<li><p>This is used to identify the SOME/IP-SD Instance even in cases in which the IP-Address and/or Port Number cannot be used.</p></li>
<li><p>A use case would be a proxy service discovery on one ECU which handles the multicast traffic for another ECU.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id30">
<img alt="../_images/SOMEIPSDIPv6SDEndpointOption.png" class="with-border" src="../_images/SOMEIPSDIPv6SDEndpointOption.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP-SD IPv6 SD Endpoint Option</strong></span><a class="headerlink" href="#id30" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Example:Below Figure shows an example with the different Endpoint and a Multicast Option:</p></li>
<li><p>The Server offers the Service Instance on Server UDP-Endpoint SU and Server TCP-Endpoint ST</p></li>
<li><p>The Client sends a Subscribe Eventgroup entry with Client UDP-Endpoint CU (unicast) and a Client TCP-Endpoint CT.</p></li>
</ul>
<figure class="align-center" id="id31">
<img alt="../_images/Publish_Subcribe_example_for_Endpointoptions_and_the_usage_of_ports.png" class="with-border" src="../_images/Publish_Subcribe_example_for_Endpointoptions_and_the_usage_of_ports.png" />
<figcaption>
<p><span class="caption-text"><strong>Publish/Subscribe Example for Endpoint Options and the usage of ports</strong></span><a class="headerlink" href="#id31" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="service-entries">
<h4><span class="section-number">4.4.1.4. </span><strong>Service Entries</strong><a class="headerlink" href="#service-entries" title="Link to this heading"></a></h4>
<section id="find-service-entry">
<h5><span class="section-number">4.4.1.4.1. </span><strong>Find Service Entry</strong><a class="headerlink" href="#find-service-entry" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The Find Service entry type is used for finding service instances and will only be sent if the current state of a service is unknown.(no current Service Offer was received and is still valid).</p></li>
<li><p>Find Service entries sets the entry fields in the following way:</p></li>
</ul>
</div></blockquote>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Field</strong></p></td>
<td><p><strong>Description(Default Value)</strong></p></td>
</tr>
<tr class="row-even"><td><p>Type</p></td>
<td><p>0x00 (FindService)</p></td>
</tr>
<tr class="row-odd"><td><p>Service ID</p></td>
<td><p>Set to the Service ID of the service</p></td>
</tr>
<tr class="row-even"><td><p>Instance ID</p></td>
<td><p>0xFFFF(all service instances) or Instance ID of a specific service instance</p></td>
</tr>
<tr class="row-odd"><td><p>Major Version</p></td>
<td><p>0xFF</p></td>
</tr>
<tr class="row-even"><td><p>Minor Version</p></td>
<td><p>0xFFFFFFFF(services with any version will be returned) or set to a value different to
0xFFFFFFFF, services with this specific minor version will be returned only</p></td>
</tr>
<tr class="row-odd"><td><p>TTL</p></td>
<td><p>Set to the lifetime of the Find Service entry. After this lifetime the Find Service entry
is considered not existing. If TTL is set to 0xFFFFFF, the Find Service entry is
considered valid until the next reboot. TTL will not be set to 0x000000 since this is
considered to be the Stop Find Service Entry.</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><ul class="simple">
<li><p>Find the wireshark output for FindService service below.</p></li>
<li><p>Consider IP address 192.168.7.4 for consumer application, 192.168.7.2 for producer application and 224.244.224.245 as a multicast address.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id32">
<img alt="../_images/FindService_Wireshark.png" class="with-border" src="../_images/FindService_Wireshark.png" />
<figcaption>
<p><span class="caption-text"><strong>Wireshark output for FindService()</strong></span><a class="headerlink" href="#id32" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="offer-service-entry">
<h5><span class="section-number">4.4.1.4.2. </span>Offer Service Entry<a class="headerlink" href="#offer-service-entry" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The Offer Service entry type is used to offer a service to other communication partners.</p></li>
</ul>
</div></blockquote>
<p>Offer Service entries sets the entry fields in the following way:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Field</strong></p></td>
<td><p><strong>Description(Default Value)</strong></p></td>
</tr>
<tr class="row-even"><td><p>Type</p></td>
<td><p>0x00 (OfferService)</p></td>
</tr>
<tr class="row-odd"><td><p>Service ID</p></td>
<td><p>Set to the Service ID of the service instance offered.</p></td>
</tr>
<tr class="row-even"><td><p>Instance ID</p></td>
<td><p>Set to the Instance ID of the service instance that is offered</p></td>
</tr>
<tr class="row-odd"><td><p>Major Version</p></td>
<td><p>Set to the Major Version of the service instance that is offered.</p></td>
</tr>
<tr class="row-even"><td><p>Minor Version</p></td>
<td><p>Set to the Minor Version of the service instance that is offered.</p></td>
</tr>
<tr class="row-odd"><td><p>TTL</p></td>
<td><p>Set to the lifetime of the Offer Service entry. After this lifetime the Offer Service
entry is considered not existing. If TTL is set to 0xFFFFFF, the Offer Service entry will
be considered valid until the next reboot. TTL will not be set to 0x000000 since this is
considered to be the Stop Offer Service Entry.</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><ul class="simple">
<li><p>Find the wireshark output for OfferService service below.</p></li>
<li><p>Consider IP address 192.168.7.4 for consumer application, 192.168.7.2 for producer application and 224.244.224.245 as a multicast address.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id33">
<img alt="../_images/Wireshark_output_for_OfferService.png" class="with-border" src="../_images/Wireshark_output_for_OfferService.png" />
<figcaption>
<p><span class="caption-text"><strong>Wireshark output for OfferService()</strong></span><a class="headerlink" href="#id33" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="eventgroup-entry">
<h4><span class="section-number">4.4.1.5. </span>Eventgroup Entry<a class="headerlink" href="#eventgroup-entry" title="Link to this heading"></a></h4>
<section id="subscribe-eventgroup-entry">
<h5><span class="section-number">4.4.1.5.1. </span>Subscribe Eventgroup Entry<a class="headerlink" href="#subscribe-eventgroup-entry" title="Link to this heading"></a></h5>
<p>The Subscribe Eventgroup entry type is used to subscribe to an eventgroup.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Field</strong></p></td>
<td><p><strong>Description(Default Value)</strong></p></td>
</tr>
<tr class="row-even"><td><p>Type</p></td>
<td><p>0x06 (SubscribeEventgroup)</p></td>
</tr>
<tr class="row-odd"><td><p>Service ID</p></td>
<td><p>set to the Service ID of the service instance that includes the eventgroup subscribed to.</p></td>
</tr>
<tr class="row-even"><td><p>Instance ID</p></td>
<td><p>set to the Instance ID of the service instance that includes the eventgroup subscribed to.</p></td>
</tr>
<tr class="row-odd"><td><p>Major Version</p></td>
<td><p>set to the Major Version of the service instance of the eventgroup subscribed to.</p></td>
</tr>
<tr class="row-even"><td><p>Eventgroup ID</p></td>
<td><p>set to the Eventgroup ID of the eventgroup subscribed to.</p></td>
</tr>
<tr class="row-odd"><td><p>Minor Version</p></td>
<td><p>set to the Minor Version of the service instance of the eventgroup subscribed to.</p></td>
</tr>
<tr class="row-even"><td><p>TTL</p></td>
<td><p>If set to 0xFFFFFF, the Subscribe Eventgroup entry considered as valid until the next
reboot. TTL will not be set to 0x000000 since this is considered to be the stop.</p></td>
</tr>
<tr class="row-odd"><td><p>Reserved</p></td>
<td><p>set to 0x00</p></td>
</tr>
<tr class="row-even"><td><p>Initial Data
Requested flag</p></td>
<td><p>set to 1, if the client sends the first subscribe in sequence to trigger the sending of
initial events. Set to 0 otherwise.</p></td>
</tr>
<tr class="row-odd"><td><p>Reserved2</p></td>
<td><p>set to three 0 bits</p></td>
</tr>
<tr class="row-even"><td><p>Counter</p></td>
<td><p>used to differentiate between parallel subscribes to the same eventgroup of the same
service (only difference in endpoint). If not used, set to 0x0.</p></td>
</tr>
</tbody>
</table>
<figure class="align-center" id="id34">
<img alt="../_images/SubscribeEG_Wireshark.png" class="with-border" src="../_images/SubscribeEG_Wireshark.png" />
<figcaption>
<p><span class="caption-text"><strong>Wireshark output for SubscribeEventgroup()</strong></span><a class="headerlink" href="#id34" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="subscribe-eventgroup-acknowledgement-subscribe-eventgroup-ack-entry">
<h5><span class="section-number">4.4.1.5.2. </span>Subscribe Eventgroup Acknowledgement (Subscribe Eventgroup Ack) Entry<a class="headerlink" href="#subscribe-eventgroup-acknowledgement-subscribe-eventgroup-ack-entry" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The Subscribe Eventgroup Acknowledgment entry type is used to indicate that Subscribe Eventgroup entry was accepted.</p></li>
<li><p>Type: 0x07 (SubscribeEventgroupAck).</p></li>
<li><p>Service ID, Instance ID, Major Version, Eventgroup ID, Counter, and Reserved are same value as in the Subscribe that is being answered.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id35">
<img alt="../_images/SubscribeEgAck_Wireshark.png" class="with-border" src="../_images/SubscribeEgAck_Wireshark.png" />
<figcaption>
<p><span class="caption-text"><strong>Wireshark output for SubscribeEventgroupAck()</strong></span><a class="headerlink" href="#id35" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="service-discovery-communication-behavior">
<h4><span class="section-number">4.4.1.6. </span><strong>Service Discovery Communication Behavior</strong><a class="headerlink" href="#service-discovery-communication-behavior" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>SOME/IP Service Discovery reduces the number of Service Discovery messages by packing entries together whenever possible.</p></li>
</ul>
<section id="startup-behavior">
<h5><span class="section-number">4.4.1.6.1. </span><strong>Startup Behavior</strong><a class="headerlink" href="#startup-behavior" title="Link to this heading"></a></h5>
<p>For each Service Instance or Eventgroup the Service Discovery have at least these three phases in regard to sending entries:</p>
<blockquote>
<div><ul class="simple">
<li><p>Initial Wait Phase</p></li>
<li><p>Repetition Phase</p></li>
<li><p>Main Phase</p></li>
<li><p>The service discovery enters the InitialWait Phase for a client service instance when the link on the interface needed for this service instance is up and the client service is requested by the application.</p></li>
<li><p>The service discovery enters the Initial Wait Phase for a server service instance when the link on the interface needed for this service instance is up and the server service is available.</p></li>
<li><p>The Service Discovery waits based on the INITIAL_DELAY after entering the Initial Wait Phase and before sending the first messages for the Service Instance.</p></li>
<li><p>INITIAL_DELAY defined as a minimum and a maximum delay.</p></li>
</ul>
</div></blockquote>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">INITIAL</span><span class="o">-</span><span class="n">DELAY</span><span class="o">-</span><span class="n">MAX</span><span class="o">-</span><span class="n">VALUE</span><span class="o">&gt;</span><span class="mf">0.1</span><span class="o">&lt;/</span><span class="n">INITIAL</span><span class="o">-</span><span class="n">DELAY</span><span class="o">-</span><span class="n">MAX</span><span class="o">-</span><span class="n">VALUE</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">INITIAL</span><span class="o">-</span><span class="n">DELAY</span><span class="o">-</span><span class="n">MIN</span><span class="o">-</span><span class="n">VALUE</span><span class="o">&gt;</span><span class="mf">0.01</span><span class="o">&lt;/</span><span class="n">INITIAL</span><span class="o">-</span><span class="n">DELAY</span><span class="o">-</span><span class="n">MIN</span><span class="o">-</span><span class="n">VALUE</span><span class="o">&gt;</span>

<span class="o">-</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">wait</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">determined</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">choosing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">minimum</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">INITIAL_DELAY</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Repetition</span><span class="w"> </span><span class="n">Phase</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">Instance</span><span class="o">/</span><span class="n">these</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">Instances</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">entered</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">Discovery</span><span class="w"> </span><span class="n">waits</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Repetitions</span><span class="w"> </span><span class="n">Phase</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">REPETITIONS_BASE_DELAY</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Repetition</span><span class="w"> </span><span class="n">Phase</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">doubled</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">Discovery</span><span class="w"> </span><span class="n">sends</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">REPETITIONS_MAX</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Repetition</span><span class="w"> </span><span class="n">Phase</span><span class="p">.</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">INITIAL</span><span class="o">-</span><span class="n">REPETITIONS</span><span class="o">-</span><span class="n">BASE</span><span class="o">-</span><span class="n">DELAY</span><span class="o">&gt;</span><span class="mf">0.2</span><span class="o">&lt;/</span><span class="n">INITIAL</span><span class="o">-</span><span class="n">REPETITIONS</span><span class="o">-</span><span class="n">BASE</span><span class="o">-</span><span class="n">DELAY</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">INITIAL</span><span class="o">-</span><span class="n">REPETITIONS</span><span class="o">-</span><span class="n">MAX</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;/</span><span class="n">INITIAL</span><span class="o">-</span><span class="n">REPETITIONS</span><span class="o">-</span><span class="n">MAX</span><span class="o">&gt;</span>

<span class="o">-</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Repetition</span><span class="w"> </span><span class="n">Phase</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="n">Phase</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">entered</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">Instance</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">entering</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="n">Phase</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">provider</span><span class="w"> </span><span class="n">waits</span><span class="w"> </span><span class="mi">1</span><span class="o">*</span><span class="n">CYCLIC_OFFER_DELAY</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">offer</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">message</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="n">Phase</span><span class="w"> </span><span class="n">Offer</span><span class="w"> </span><span class="n">Messages</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">cyclically</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">CYCLIC_OFFER_DELAY</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">configured</span><span class="p">.</span>
<span class="o">-</span><span class="w"> </span><span class="n">After</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">Instance</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">Discovery</span><span class="w"> </span><span class="n">waits</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">1</span><span class="o">*</span><span class="n">CYCLIC_OFFER_DELAY</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="n">Instance</span><span class="p">.</span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">OFFER</span><span class="o">-</span><span class="n">CYCLIC</span><span class="o">-</span><span class="n">DELAY</span><span class="o">&gt;</span><span class="mf">2.0</span><span class="o">&lt;/</span><span class="n">OFFER</span><span class="o">-</span><span class="n">CYCLIC</span><span class="o">-</span><span class="n">DELAY</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Example:
Initial Wait Phase:</p>
<ul class="simple">
<li><p>Wait for random_delay in Range(INITIAL_DELAY_MIN, _MAX)</p></li>
<li><p>Send message (Find Service and Offer Service entries)</p></li>
</ul>
<p>Repetition Phase (REPETITIONS_BASE_DELAY=100ms, REPETITIONS_MAX=2):</p>
<blockquote>
<div><ul class="simple">
<li><p>Wait 2^0 * 100ms</p></li>
<li><p>Send message (Find Service and Offer Service entries)</p></li>
<li><p>Wait 2^1 * 100ms</p></li>
<li><p>Send message (Find Service and Offer Service entries)</p></li>
</ul>
</div></blockquote>
<p>Main Phase (as long message is active and CYCLIC_OFFER_DELAY is defined):</p>
<blockquote>
<div><ul class="simple">
<li><p>Wait CYCLIC_OFFER_DELAY</p></li>
<li><p>Send message (Offer Service entries)</p></li>
</ul>
</div></blockquote>
</section>
<section id="server-answer-behavior">
<h5><span class="section-number">4.4.1.6.2. </span><strong>Server Answer Behavior</strong><a class="headerlink" href="#server-answer-behavior" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>The Service Discovery delay answers to entries that were received in multicast SOME/IP-SD messages using the configuration item REQUEST_RESPONSE_DELAY.</p></li>
<li><p>The REQUEST_RESPONSE_DELAY will not apply if unicast messages are answered with unicast messages.</p></li>
<li><p>REQUEST_RESPONSE_DELAY will be specified by a minimum and a maximum.</p></li>
<li><p>The actual delay is randomly chosen between minimum and maximum of REQUEST_RESPONSE_DELAY.</p></li>
</ul>
</div></blockquote>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">REQUEST</span><span class="o">-</span><span class="n">RESPONSE</span><span class="o">-</span><span class="n">DELAY</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">MAX</span><span class="o">-</span><span class="n">VALUE</span><span class="o">&gt;</span><span class="mf">1.5</span><span class="o">&lt;/</span><span class="n">MAX</span><span class="o">-</span><span class="n">VALUE</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">MIN</span><span class="o">-</span><span class="n">VALUE</span><span class="o">&gt;</span><span class="mf">1.5</span><span class="o">&lt;/</span><span class="n">MIN</span><span class="o">-</span><span class="n">VALUE</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">REQUEST</span><span class="o">-</span><span class="n">RESPONSE</span><span class="o">-</span><span class="n">DELAY</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="shutdown-behavior">
<h5><span class="section-number">4.4.1.6.3. </span><strong>Shutdown Behavior</strong><a class="headerlink" href="#shutdown-behavior" title="Link to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>When a server service instance of an ECU is in the Repetition and Main Phase and is being stopped, a Stop Offer Service entry will be sent out.</p></li>
<li><p>When a server sends out a Stop Offer Service entry all subscriptions for this service instance get deleted on the server side.</p></li>
<li><p>When the whole ECUs is being shut down Stop Offer Service entries will be sent out for all service entries and Stop Subscribe Eventgroup entries for Eventgroups.</p></li>
<li><p>TTL(Time to live) : Describes the lifetime of the entry in seconds</p></li>
</ul>
</div></blockquote>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">SERVICE</span><span class="o">-</span><span class="n">OFFER</span><span class="o">-</span><span class="n">TIME</span><span class="o">-</span><span class="n">TO</span><span class="o">-</span><span class="n">LIVE</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">SERVICE</span><span class="o">-</span><span class="n">OFFER</span><span class="o">-</span><span class="n">TIME</span><span class="o">-</span><span class="n">TO</span><span class="o">-</span><span class="n">LIVE</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="generation-of-vsomeip-json">
<h4><span class="section-number">4.4.1.7. </span><strong>Generation of vsomeip.json</strong><a class="headerlink" href="#generation-of-vsomeip-json" title="Link to this heading"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>In case of adaptive platform, vsomeip.json will get generated from system_manifest.arxml file by using jsongen.py scripts.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id36">
<img alt="../_images/Generated_Output.png" class="with-border" src="../_images/Generated_Output.png" />
<figcaption>
<p><span class="caption-text"><strong>Generated Output(vsomeip.json)</strong></span><a class="headerlink" href="#id36" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
</section>
<section id="ara-com-api">
<h2><span class="section-number">4.5. </span>ARA Com API<a class="headerlink" href="#ara-com-api" title="Link to this heading"></a></h2>
<p>Existing communication middleware API/technology are listed below:</p>
<ul class="simple">
<li><p><strong>ROS(Robot Operating System) API</strong></p></li>
<li><p><strong>DDS(Data Distribution Service) API</strong></p></li>
<li><p><strong>CommonAPI(GENIVI)</strong></p></li>
<li><p><strong>DADDY API(Bosch)</strong></p></li>
</ul>
<p>Decision to come up with a new and AUTOSAR-specific Communication Management API was due to the fact, that not all of the key requirements were met by existing solutions:</p>
<ul class="simple">
<li><p>Need for a Communication Management, which is NOT bound to a concrete network communication protocol. It has to support the SOME/IP protocol along with the flexibility to exchange that.</p></li>
<li><p>The AUTOSAR service model, which defines services as a collection of provided methods, events and fields are supported naturally/straight forward.</p></li>
<li><p>The API supports an event-driven and a polling model to get access to communicated data equally . The latter is needed by real-time applications to avoid unnecessary context switches, while the former is much more convenient for applications without real-time requirements.</p></li>
<li><p>Possibility for seamless integration of end-to-end protection to fulfill ASIL requirements.</p></li>
<li><p>Support for static (preconfigured) and dynamic (runtime) selection of service instances to communicate with.</p></li>
</ul>
<p><strong>ara::com only defines the API signatures and its behaviour visible to the application developer. Providing an implementation of those APIs and the underlying middleware transport layer is the responsibility of the AUTOSAR AP vendor.</strong></p>
<section id="high-level-api-structure">
<h3><span class="section-number">4.5.1. </span>High Level API Structure<a class="headerlink" href="#high-level-api-structure" title="Link to this heading"></a></h3>
<section id="proxy-skeleton-architecture">
<h4><span class="section-number">4.5.1.1. </span>Proxy/Skeleton Architecture<a class="headerlink" href="#proxy-skeleton-architecture" title="Link to this heading"></a></h4>
<p>The basic idea of this pattern is, that from a formal service definition two code artifacts are generated:
Proxy Skeleton Pattern</p>
<figure class="align-center" id="id37">
<img alt="../_images/Proxy_Skeleton_Pattern.png" class="with-border" src="../_images/Proxy_Skeleton_Pattern.png" />
<figcaption>
<p><span class="caption-text"><strong>Proxy Skeleton Pattern</strong></span><a class="headerlink" href="#id37" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p><strong>Service Proxy:</strong> This code is from the perspective of the service consumer, which wants to use a possibly remote service. Service proxy represents this service on code level.</p></li>
<li><p><strong>Service Skeleton:</strong> This code is from the perspective of the service implementation, which provides functionalities according to the service definition - Connects the service implementation to the Communication Management transport layer, so that the service implementation can be contacted by distributed service consumers.</p></li>
</ul>
</section>
</section>
<section id="data-type-abstractions">
<h3><span class="section-number">4.5.2. </span>Data Type Abstractions<a class="headerlink" href="#data-type-abstractions" title="Link to this heading"></a></h3>
<p>ara::com API introduces specific datatypes, which are used throughout its various interfaces. They can roughly be divided into the following classes:</p>
<p><strong>Pointer types:</strong> for pointers to data transmitted via middleware.</p>
<p><strong>Collection types:</strong> for collections of data transmitted via middleware.</p>
<p><strong>Types for async operation result management:</strong> ara::com specific versions of C++ std::future and std::promise.</p>
<p><strong>Function wrappers:</strong> for various application side callback or handler functions to be called by the middleware.</p>
<p>ara::com defines signature and expected behavior of those types, but does not provide an implementation. The idea of this approach is, that platform vendors could easily come up with their own optimized implementation of those types.</p>
</section>
<section id="error-notification">
<h3><span class="section-number">4.5.3. </span>Error Notification<a class="headerlink" href="#error-notification" title="Link to this heading"></a></h3>
<p>ara::com API follows the concepts of error handling described in chapter “Error handling”. Checked Errors will be returned via ara::core::ErrorCode directly or an ara::core::ErrorCode embedded into a ara::core::Result, which either holds a valid return value or the ara::core::ErrorCode.</p>
<p>The functionality provided with ara::core::Result and ara::core::Future  allow the user of ara::com to chose between exception based or return code based error handling to some degree.</p>
<section id="checked-exceptions">
<h4><span class="section-number">4.5.3.1. </span>Checked Exceptions<a class="headerlink" href="#checked-exceptions" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Checked Exceptions within ara::com API can only occur in the context of a call of a service interface method.</p></li>
</ul>
</section>
<section id="unchecked-exceptions">
<h4><span class="section-number">4.5.3.2. </span>Unchecked Exceptions<a class="headerlink" href="#unchecked-exceptions" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Unchecked Exceptions within ara::com API can basically occur in the context of any ara::com API call and are fully ara::com implementation specific! A property of unchecked exceptions is, that programs/program artifacts hitting such an exception can typically not recover from it.</p></li>
</ul>
</section>
</section>
</section>
<section id="api-elements">
<h2><span class="section-number">4.6. </span>API Elements<a class="headerlink" href="#api-elements" title="Link to this heading"></a></h2>
<p>A virtual service (interface) called “RadarService is defined in the below example.</p>
<figure class="align-center" id="id38">
<img alt="../_images/RadarService_Definition.png" class="with-border" src="../_images/RadarService_Definition.png" />
<figcaption>
<p><span class="caption-text"><strong>RadarService Definition</strong></span><a class="headerlink" href="#id38" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>So the example service RadarService provides an event called “BrakeEvent”, which consists of a structure containing a flag and a variable length array of uint8 (as extra payload). A field “UpdateRate”, which is of type uint32 (supports get and set calls) and methods Adjust, Calibrate and LogCurrentState.</p>
<p>Method “Adjust” is used to position the radar. It contains a target position as in-parameter and two out-parameters. One to signal the success of the positioning and other to report the final (maybe deviating) effective position. The method “Calibrate” is used to calibrate the radar. It contains a configuration string as in-parameter and returning a success indicator as an out-parameter. “Calibrate” method may raise two different application errors, in case of the calibration failure: “CalibrationFailed” and “InvalidConfigString”. The method “LogCurrentState” is a one way method, which means, no feedback is returned to the caller. It instructs the service RadarService to output its current state into its local log files.</p>
<section id="common-types">
<h3><span class="section-number">4.6.1. </span>Common Types<a class="headerlink" href="#common-types" title="Link to this heading"></a></h3>
<section id="optional-data-elements">
<h4><span class="section-number">4.6.1.1. </span>Optional data elements<a class="headerlink" href="#optional-data-elements" title="Link to this heading"></a></h4>
<p>The structure in below Figure has the optional declared elements “current and health”. These elements are not mandatorily present. The consuming application has to check whether the optional elements contain a value or not during runtime. Optional element contains a may or may not contain a value depends on the providing application. The providing application may or may not set the value for that specific instance. The feature of optional contained elements provide forward and backward compatibility of the service interface as new added record elements can just be ignored by old applications.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">BatteryState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Voltage_t</span><span class="w"> </span><span class="n">voltage</span><span class="p">;</span>
<span class="w">    </span><span class="n">Temperature_t</span><span class="w"> </span><span class="n">temperature</span><span class="p">;</span>
<span class="w">    </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">optional</span><span class="o">&lt;</span><span class="n">Current_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">current</span><span class="p">;</span>
<span class="w">    </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">optional</span><span class="o">&lt;</span><span class="n">Health</span><span class="o">&gt;</span><span class="w"> </span><span class="n">health</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
</section>
<section id="instance-identifiers">
<h3><span class="section-number">4.6.2. </span>Instance Identifiers<a class="headerlink" href="#instance-identifiers" title="Link to this heading"></a></h3>
<p>Instance identifiers are used within ara::com, on client/proxy side, when a specific instance of a service shall be searched for or at the server/skeleton side when a specific instance of a service is created.</p>
<p>At ara::com API level the instance identifier is generally a technical binding specific identifier.</p>
<p>Instance identifiers are used within ara::com during following scenarios:</p>
<ul class="simple">
<li><p>On client/proxy side when a specific instance of a service will be searched for.</p></li>
<li><p>At the server/skeleton side when a specific instance of a service is created.</p></li>
</ul>
<p>At ara::com API level the instance identifier is a technical binding specific identifier. The content of instance identifier are totally technology specific.</p>
<p>Example: SOME/IP is using 16 bit unsigned integer, while DDS (DDS-RPC) uses string&lt;256&gt; as service_instance_name.</p>
<p>Independant of the binding technology, instance identifier complying to a signature given below.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">class</span><span class="w"> </span><span class="n">InstanceIdentifier</span><span class="w"> </span><span class="p">{</span>
<span class="n">public</span><span class="o">:</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InstanceIdentifier</span><span class="w"> </span><span class="n">Any</span><span class="p">;</span>
<span class="w">    </span><span class="n">explicit</span><span class="w"> </span><span class="nf">InstanceIdentifier</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">InstanceIdentifier</span><span class="o">&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">InstanceIdentifier</span><span class="o">&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="n">InstanceIdentifier</span><span class="o">&amp;</span><span class="w"> </span><span class="n">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">InstanceIdentifier</span><span class="o">&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>An ara:com provided functionality, which translates a logical local name used by the software developer in his realm into the technology/binding specific ara::com::InstanceIdentifier.</p>
<p>The local name from which the ara::com::InstanceIdentifier is constructed comes basically from AUTOSAR meta-model, describing your software component model.</p>
<p>The requirement for this local name(abstract identifier) is, that it is unambiguous within an executable. It has basically the form:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">context</span><span class="w"> </span><span class="mi">0</span><span class="o">&gt;::&lt;</span><span class="n">context</span><span class="w"> </span><span class="mi">1</span><span class="o">&gt;::</span><span class="p">...</span><span class="o">::&lt;</span><span class="n">context</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;::&lt;</span><span class="n">port</span><span class="w"> </span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="instance-specifier">
<h3><span class="section-number">4.6.3. </span>Instance Specifier<a class="headerlink" href="#instance-specifier" title="Link to this heading"></a></h3>
<p>The C++ representation of such an “instance specifier” is the class ara::core::InstanceSpecifier. Structurally it looks similar to the ara::com::InstanceIdentifier:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">class</span><span class="w"> </span><span class="n">InstanceSpecifier</span><span class="w"> </span><span class="p">{</span>
<span class="n">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// ctor to build specifier from AUTOSAR short name identifier</span>
<span class="w">    </span><span class="c1">// with ’/’ as separator between package names</span>
<span class="w">    </span><span class="n">explicit</span><span class="w"> </span><span class="n">InstanceSpecifier</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">:</span><span class="n">string_view</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">:</span><span class="n">string_view</span><span class="w"> </span><span class="n">toString</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">InstanceSpecifier</span><span class="o">&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">InstanceSpecifier</span><span class="o">&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="n">InstanceSpecifier</span><span class="o">&amp;</span><span class="w"> </span><span class="n">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">InstanceSpecifier</span><span class="o">&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>If the unambiguousness is ensured, the integrator/deployer can assign a dedicated technical binding with its specific instance IDs to those “instance specifier” via a “manifest file”, which is specifically used for a distinct instantiation/execution of the executable.</p>
<p>This explicitly allows, to start the same executable N times, each time with a different manifest, which maps the same ara::core::InstanceSpecifier differently.</p>
</section>
<section id="instance-identifier-container">
<h3><span class="section-number">4.6.4. </span>Instance Identifier Container<a class="headerlink" href="#instance-identifier-container" title="Link to this heading"></a></h3>
<p>The API ara:com provides the following function, to do the translation from the ara::core::InstanceSpecifier (local name in the software developers realm) to thetechnical ara::com::InstanceIdentifier:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">namespace</span><span class="w"> </span><span class="n">ara</span><span class="w"> </span><span class="p">{</span>
<span class="n">namespace</span><span class="w"> </span><span class="n">com</span><span class="w"> </span><span class="p">{</span>
<span class="n">namespace</span><span class="w"> </span><span class="n">runtime</span><span class="w"> </span><span class="p">{</span>
<span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">InstanceIdentifierContainer</span><span class="w"> </span><span class="nf">ara::com::runtime::ResolveInstanceIDs</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">::</span><span class="n">InstanceSpecifier</span><span class="w"> </span><span class="n">modelName</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Why this API does return an InstanceIdentifierContainer, which represents a collection of ara::com::InstanceIdentifier is in need of explanation:
AUTOSAR supports, that the integrator may configure multiple technical bindings behind one abstract identifier visible to the software component developer.</p>
<p>This feature is called multi-binding. Using multi-binding on the skeleton/server side is a common use case, since it simply allows different clients to use their preferred binding, when contacting the server.</p>
<p>Contrary using multi-binding on the proxy/client side is a rather exotic one. E.g. it could be used to support some fail-over approaches (if binding A does not work, fall back on binding B).</p>
<p>So the possible returns for a call of ResolveInstanceIDs() are:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Empty list:</strong> The integrator failed to provide a mapping for the abstract identifier. This most likely is a configuration error.</p></li>
<li><p><strong>List with one element:</strong> The common case. Mapping to one concrete instance id of one concrete technical binding.</p></li>
<li><p><strong>List with more than one element:</strong> Mapping to multiple technical instances with possibly multiple technical bindings.</p></li>
</ul>
</div></blockquote>
<p>Technically the middleware implementation of ResolveInstanceIDs() does a lookup of the ara::core::InstanceSpecifier from the service instance manifest bundled within the process. Therefore the ara::core::InstanceSpecifier must be unambiguous within the bundled service instance manifest.</p>
<p>Therefore the ara::core::InstanceSpecifier must be unambiguous within the bundled service instance manifest.</p>
</section>
<section id="proxy-class">
<h3><span class="section-number">4.6.5. </span>Proxy Class<a class="headerlink" href="#proxy-class" title="Link to this heading"></a></h3>
<p>ara::com does standardization of the interface of the generated Proxy class.</p>
<p><strong>Note:The interfaces , Proxy class has to provide are defined by ara::com, a generic (product independent) generator could generate an abstract class or a mock class against which the application developer could implement the service consumer application. This perfectly suits the platform vendor independent development of Adaptive AUTOSAR SWCs.</strong></p>
<p>ara::com expects proxy related artifacts inside a namespace “proxy”. This namespace is typically included in a namespace hierarchy deduced from the service definition and its context.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">class</span><span class="w"> </span><span class="n">RadarServiceProxy</span><span class="w"> </span><span class="p">{</span>
<span class="n">public</span><span class="o">:</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Implementation is platform vendor specific.</span>
<span class="cm">     * A HandleType must contain the information that is needed to create a proxy.</span>
<span class="cm">     * This information will be hidden.</span>
<span class="cm">     * Since the platform vendor is responsible for creation of handles, the</span>
<span class="cm">     * ctor signature is not given as it is not of interest to the user.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">class</span><span class="w"> </span><span class="n">HandleType</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/*</span>
<span class="cm">         * Two ServiceHandles are considered equal if they represent the same service instance.</span>
<span class="cm">         * param other</span>
<span class="cm">         * return</span>
<span class="cm">         */</span>
<span class="w">        </span><span class="kr">inline</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">HandleType</span><span class="w"> </span><span class="o">&amp;</span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">InstanceIdentifier</span><span class="w"> </span><span class="o">&amp;</span><span class="nf">GetInstanceId</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * StartFindService does not need an explicit version parameter as this is internally available in ProxyClass.</span>
<span class="cm">     * That means only compatible services are returned.</span>
<span class="cm">     *</span>
<span class="cm">     * param handler this handler gets called any time the service availability of the services matching the given</span>
<span class="cm">     * instance criteria changes. If you use this variant of FindService, the Communication Management has to</span>
<span class="cm">     * continuously monitor the availability of the services and call the handler on any change.</span>
<span class="cm">     *</span>
<span class="cm">     * \param instanceId which instance of the service type defined</span>
<span class="cm">     * by T shall be searched/found.</span>
<span class="cm">     *</span>
<span class="cm">     * return a handle for this search/find request, which will be used to</span>
<span class="cm">     * stop the availability monitoring and related</span>
<span class="cm">     * firing of the given handler. (\see StopFindService())</span>
<span class="cm">     **/</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">FindServiceHandle</span><span class="w"> </span><span class="nf">StartFindService</span><span class="p">(</span>
<span class="w">    </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">FindServiceHandler</span><span class="o">&lt;</span><span class="n">RadarServiceProxy</span><span class="o">::</span><span class="n">HandleType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">handler</span><span class="p">,</span>
<span class="w">    </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">InstanceIdentifier</span><span class="w"> </span><span class="n">instanceId</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * This is an overload of the StartFindService method using an</span>
<span class="cm">     * instance specifier, which gets resolved via service instance</span>
<span class="cm">     * manifest.</span>
<span class="cm">     * \param instanceSpec instance specifier</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">FindServiceHandle</span><span class="w"> </span><span class="nf">StartFindService</span><span class="p">(</span>
<span class="w">    </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">FindServiceHandler</span><span class="o">&lt;</span><span class="n">RadarServiceProxy</span><span class="o">::</span><span class="n">HandleType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">handler</span><span class="p">,</span>
<span class="w">    </span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">::</span><span class="n">InstanceSpecifier</span><span class="w"> </span><span class="n">instanceSpec</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * This is an overload of the StartFindService method using neither</span>
<span class="cm">     * instance specifier nor instance identifier.</span>
<span class="cm">     * Semantics is, that ALL instances of the service shall be found, by</span>
<span class="cm">     * using all available/configured technical bindings.</span>
<span class="cm">     *</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">FindServiceHandle</span><span class="w"> </span><span class="nf">StartFindService</span><span class="p">(</span>
<span class="w">    </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">FindServiceHandler</span><span class="o">&lt;</span><span class="n">RadarServiceProxy</span><span class="o">::</span><span class="n">HandleType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">handler</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Method to stop finding service request (see above)</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">StopFindService</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">FindServiceHandle</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Opposed to StartFindService(handler, instance) this version is a &quot;oneshot&quot;</span>
<span class="cm">     * find request, which is</span>
<span class="cm">     * - synchronous, i.e. it returns after the find has been done and a</span>
<span class="cm">     * result list of matching service instances is</span>
<span class="cm">     * available. (list may be empty, if no matching service instances</span>
<span class="cm">     * currently exist)</span>
<span class="cm">     * - does reflect the availability at the time of the method call. No</span>
<span class="cm">     * further (background) checks of availability</span>
<span class="cm">     * are done.</span>
<span class="cm">     *</span>
<span class="cm">     * \param instanceId which instance of the service type defined</span>
<span class="cm">     * by T shall be searched/found.</span>
<span class="cm">     *</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">ServiceHandleContainer</span><span class="o">&lt;</span><span class="n">RadarServiceProxy</span><span class="o">::</span><span class="n">HandleType</span><span class="o">&gt;</span>
<span class="w">   </span><span class="n">FindService</span><span class="p">(</span>
<span class="w">        </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">InstanceIdentifier</span><span class="w"> </span><span class="n">instanceId</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * This is an overload of the FindService method using an</span>
<span class="cm">     * instance specifier, which gets resolved via service instance</span>
<span class="cm">     * manifest.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">ServiceHandleContainer</span><span class="o">&lt;</span><span class="n">RadarServiceProxy</span><span class="o">::</span><span class="n">HandleType</span><span class="o">&gt;</span>
<span class="w">   </span><span class="n">FindService</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">::</span><span class="n">InstanceSpecifier</span><span class="w"> </span><span class="n">instanceSpec</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * This is an overload of the StartFindService method using neither</span>
<span class="cm">     * instance specifier nor instance identifier.</span>
<span class="cm">     * Semantics is, that ALL instances of the service shall be found, by</span>
<span class="cm">     * using all available/configured technical bindings.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">ServiceHandleContainer</span><span class="o">&lt;</span><span class="n">RadarServiceProxy</span><span class="o">::</span><span class="n">HandleType</span><span class="o">&gt;</span>
<span class="w">   </span><span class="n">FindService</span><span class="p">();</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * The proxy can only be created using a specific handle which</span>
<span class="cm">     * identifies a service.</span>
<span class="cm">     *</span>
<span class="cm">     * This handle can be a known value which is defined at deployment or it</span>
<span class="cm">     * can be obtained using the ProxyClass::FindService method.</span>
<span class="cm">     *</span>
<span class="cm">     * param handle The identification of the service the proxy should represent.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">explicit</span><span class="w"> </span><span class="nf">RadarServiceProxy</span><span class="p">(</span><span class="n">HandleType</span><span class="w"> </span><span class="o">&amp;</span><span class="n">handle</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * proxy instances are not copy constructible.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">RadarServiceProxy</span><span class="p">(</span><span class="n">RadarServiceProxy</span><span class="w"> </span><span class="o">&amp;</span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delete</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * proxy instances are not copy assignable</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">RadarServiceProxy</span><span class="o">&amp;</span><span class="w"> </span><span class="n">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RadarServiceProxy</span><span class="w"> </span><span class="o">&amp;</span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delete</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Public member for the BrakeEvent</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">events</span><span class="o">::</span><span class="n">BrakeEvent</span><span class="w"> </span><span class="n">BrakeEvent</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Public Field for UpdateRate</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">fields</span><span class="o">::</span><span class="n">UpdateRate</span><span class="w"> </span><span class="n">UpdateRate</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Public member for the Calibrate method</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">methods</span><span class="o">::</span><span class="n">Calibrate</span><span class="w"> </span><span class="n">Calibrate</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Public member for the Adjust method</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">methods</span><span class="o">::</span><span class="n">Adjust</span><span class="w"> </span><span class="n">Adjust</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Public member for the LogCurrentState fire-and-forget method</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">methods</span><span class="o">::</span><span class="n">LogCurrentState</span><span class="w"> </span><span class="n">LogCurrentState</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="constructor-and-handle-concept">
<h3><span class="section-number">4.6.6. </span>Constructor and Handle Concept<a class="headerlink" href="#constructor-and-handle-concept" title="Link to this heading"></a></h3>
<p>As seen in the above code, ara::com prescribes the Proxy class to provide a constructor. This means, that the developer is responsible for creating a proxy instance to communicate with a possibly remote service. The ctor takes a parameter of type RadarServiceProxy::HandleType — an inner class of the generated proxy class.</p>
<p>After the call to the ctor, there is proxy instance, which allows to communicate with the service. Therefore the handle has to contain the needed addressing information, so that the Communication Management binding implementation is able to contact the service.</p>
</section>
<section id="finding-services">
<h3><span class="section-number">4.6.7. </span>Finding Services<a class="headerlink" href="#finding-services" title="Link to this heading"></a></h3>
<p>The Proxy class provides class (static) methods to find service instances, which are compatible with the Proxy class.</p>
<p>Since the availability of service instances is dynamic by nature, as they have a life cycle, ara::com provides two different ways to do a ‘FindService’ for convenience:</p>
<blockquote>
<div><ul class="simple">
<li><p>StartFindService is a class method, which starts a continuous ‘FindService’ activity in the background, which notifies the caller via a given callback anytime the availability of instances of the service changes.</p></li>
<li><p>FindService is a one-off call, which returns available instances at the point in time of the call.</p></li>
</ul>
</div></blockquote>
<p>The semantics of no-argument variant is simple: Find all services of the given type, irrespective of their binding and binding specific instance identifier. Note, that only technical bindings will be used for finding/searching, which are configured for the corresponding service interface within the service instance manifest in the form of a ServiceInterfaceDeployment.</p>
<p>Both of those methods come in three different overrides, depending on the instance identifier approach taken.</p>
<blockquote>
<div><ul class="simple">
<li><p>One taking an ara::com::InstanceIdentifier.</p></li>
<li><p>one taking an ara::core::InstanceSpecifier.</p></li>
<li><p>one taking NO argument.</p></li>
</ul>
</div></blockquote>
<p>The semantics of no-argument variant is simple: Find all services of the given type, irrespective of their binding and binding specific instance identifier. Note, that only technical bindings will be used for finding/searching, which are configured for the corresponding service interface within the service instance manifest in the form of a ServiceInterfaceDeployment.</p>
<p>Both of those methods have the instance parameter in common, which allows to either search for an explicit instance of the service or any instance (which is the default parameter value). The synchronous one-off variant FindService returns a container of handles for the matching service instances, which might also be empty, if no matching service instance is currently available.</p>
<p>Opposed to that, the StartFindService returns a FindServiceHandle, which can be used to stop the ongoing background activity of monitoring service instance availability via call to StopFindService.</p>
<p>The first (and specific for this variant) parameter to StartFindService is a user provided handler function with the following signature:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">using</span><span class="w"> </span><span class="n">FindServiceHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="n">ServiceHandleContainer</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">)</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<section id="auto-update-proxy-instance">
<h4><span class="section-number">4.6.7.1. </span>Auto Update Proxy instance<a class="headerlink" href="#auto-update-proxy-instance" title="Link to this heading"></a></h4>
<p>Irrespective of the usage of one-off FindService or the StartFindService variant, in both cases a handle identifying the — possibly remote — service instance is received, from which proxy instance is created.</p>
<p>In the service based communication universe it is expected, that during the life time of the entire system (e.g. vehicle) service provider and consumer instances start up and go down frequently due to their own life cycle concepts. To deal with this, there is service discovery infrastructure, where the life cycle of service providers and consumers is monitored in terms of service offerings and service (re)subscriptions. If a service consumer application has instantiated a service proxy instance from a handle returned from some of the Find Service variants, the following sequence might possibly occur:</p>
<figure class="align-center" id="id39">
<img alt="../_images/AutoUpdatingofProxyInstance.png" class="with-border" src="../_images/AutoUpdatingofProxyInstance.png" />
<figcaption>
<p><span class="caption-text"><strong>Auto Updating of Proxy Instance</strong></span><a class="headerlink" href="#id39" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Explanation of above figure:</p>
<ul class="simple">
<li><p><strong>T0:</strong> The service consumer may successfully call a service method of that proxy and GetSubscriptionState() on subscribed events will return kSubscribed.</p></li>
<li><p><strong>T1:</strong> The service instance goes down, correctly notified via service discovery.</p></li>
<li><p><strong>T2:</strong> A call of a service method on that proxy will lead to an exception, since the targeted service instance of the call does not exist anymore. Correspondingly GetSubscriptionState() on any subscribed event will return kSubscriptionPending at this point even if the event has been successfully subscribed (kSubscribed) before.</p></li>
<li><p><strong>T3:</strong> The service instance comes up again, notified via service discovery infrastructure. The CM at the proxy side will be notified and will silently update the proxy object instance with a possibly changed transport layer addressing information. This is illustrated in the figure with transport layer part of the proxy, which changed the color from blue to rose. The Binding implementer hint part below discusses this topic more detailed.</p></li>
<li><p><strong>T4:</strong> Consequently service method calls on that proxy instance will succeed again and GetSubscriptionState() on events which the service consumer had subscribed before, will return kSubscribed again.</p></li>
</ul>
</section>
</section>
<section id="events">
<h3><span class="section-number">4.6.8. </span>Events<a class="headerlink" href="#events" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>For each event the remote service provides, the proxy class containing a member of a event specific wrapper class.</p></li>
<li><p>In the example the member has the name BrakeEvent and is of type events::BrakeEvent.</p></li>
<li><p>Below mentioned method gets generated for each event.</p></li>
</ul>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Method</strong></p></td>
<td><p><strong>Description</strong></p></td>
</tr>
<tr class="row-even"><td><p>void Subscribe(ara::com::EventCacheUpdatePolicy policy,
size_t cacheSize);</p></td>
<td><p>Used for subscription of events</p></td>
</tr>
<tr class="row-odd"><td><p>ara::com::SubscriptionState GetSubscriptionState() const;</p></td>
<td><p>Query current subscription state</p></td>
</tr>
<tr class="row-even"><td><p>void Unsubscribe();</p></td>
<td><p>Unsubscribe from the service</p></td>
</tr>
<tr class="row-odd"><td><p>void SetReceiveHandler(ara::com::EventReceiveHandler handler);</p></td>
<td><p>Setting a receive handler signals the Communication Management
implementation to use event style mode.</p></td>
</tr>
<tr class="row-even"><td><p>void UnsetReceiveHandler();</p></td>
<td><p>Remove handler set by SetReceiveHandler</p></td>
</tr>
<tr class="row-odd"><td><p>void SetSubscriptionStateChangeHandler(ara::com::
SubscriptionStateChangeHandler handler);</p></td>
<td><p>Setting a subscription state change handler, which gets called by
the Communication Management implementation as soon as  the
subscription state of this event has changed.</p></td>
</tr>
<tr class="row-even"><td><p>void UnsetSubscriptionStateChangeHandler();</p></td>
<td><p>Remove handler set by SetSubscriptionStateChangeHandler</p></td>
</tr>
<tr class="row-odd"><td><p>bool Update(ara::com::FilterFunction&lt;SampleType&gt; filter = {});</p></td>
<td><p>Fetch data from the Communication Management buffers and apply
filter before writing the samples into the cache.</p></td>
</tr>
<tr class="row-even"><td><p>const ara::com::SampleContainer&lt;ara::com::SamplePtr&lt;const
SampleType&gt;&gt; &amp; GetCachedSamples() const;</p></td>
<td><p>Get the container of the samples in the cache that was updated by
the last call of update</p></td>
</tr>
</tbody>
</table>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">class</span><span class="w"> </span><span class="n">BrakeEvent</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="cm">/*</span>
<span class="cm">   * brief Shortcut for the events data type.</span>
<span class="cm">   */</span>
<span class="w">   </span><span class="n">using</span><span class="w"> </span><span class="n">SampleType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RadarObjects</span><span class="p">;</span>
<span class="w">   </span><span class="cm">/*</span>
<span class="cm">   * brief The application expects the Communication Management to subscribe the event.</span>
<span class="cm">   *</span>
<span class="cm">   * The Communication Management will try to subscribe and resubscribe</span>
<span class="cm">     until \see Unsubscribe() is called explicitly.</span>
<span class="cm">   * The error handling will be kept within the Communication Management.</span>
<span class="cm">   *</span>
<span class="cm">   * The function return immediately. If the user wants to get notified,</span>
<span class="cm">     when subscription has succeeded, he needs</span>
<span class="cm">   * to register a handler via \see SetSubscriptionStateChangeHandler().</span>
<span class="cm">     This handler gets then called after subscription was successful.</span>
<span class="cm">   *</span>
<span class="cm">   * \param maxSampleCount maximum number of samples, which can be held.</span>
<span class="cm">   */</span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="nf">Subscribe</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">maxSampleCount</span><span class="p">);</span>
<span class="w">   </span><span class="cm">/*</span>
<span class="cm">   * brief query current subscription state.</span>
<span class="cm">   *</span>
<span class="cm">   * \return current state of the subscription.</span>
<span class="cm">   */</span>
<span class="w">   </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">SubscriptionState</span><span class="w"> </span><span class="nf">GetSubscriptionState</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">   </span><span class="cm">/*</span>
<span class="cm">   * brief Unsubscribe from the service.</span>
<span class="cm">   */</span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="nf">Unsubscribe</span><span class="p">();</span>
<span class="w">   </span><span class="cm">/*</span>
<span class="cm">   * \brief Get the number of currently free/available sample slots.</span>
<span class="cm">   * \return number from 0 - N (N = count given in call to Subscribe()) or an ErrorCode in case of</span>
<span class="cm">    number of currently held samples already exceeds the max number given in Subscribe().</span>
<span class="cm">   */</span>
<span class="w">   </span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">::</span><span class="n">Result</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetFreeSampleCount</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">noexcept</span><span class="p">;</span>
<span class="w">   </span><span class="cm">/*</span>
<span class="cm">   * \Setting a receive handler signals the Communication Management</span>
<span class="cm">   * implementation to use event style mode.</span>
<span class="cm">   * I.e. the registered handler gets called asynchronously by the</span>
<span class="cm">   * Communication Management as soon as new event data arrives for that event. If user wants to</span>
<span class="cm">   * have strict polling behaviour, where you decide when to check for new data via Update()</span>
<span class="cm">   * he should NOT register a handler.</span>
<span class="cm">   * Handler may be overwritten anytime during runtime.</span>
<span class="cm">   *</span>
<span class="cm">   * Provided Handler needs not to be re-entrant since the Communication</span>
<span class="cm">   * Management implementation has to serialize calls to the handler: Handler gets called</span>
<span class="cm">   * once by the MW, when new events arrived since the last call to GetNewSamples().</span>
<span class="cm">   * When application calls GetNewSamples() again in the context of the receive</span>
<span class="cm">   * handler, MW must - in case new events arrived in the meantime - defer next call to receive</span>
<span class="cm">     handler until after the previous call to receive handler has been completed.</span>
<span class="cm">   *</span>
<span class="cm">   **/</span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="nf">SetReceiveHandler</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">EventReceiveHandler</span><span class="w"> </span><span class="n">handler</span><span class="p">);</span>
<span class="w">   </span><span class="cm">/*</span>
<span class="cm">   * Remove handler set by SetReceiveHandler()</span>
<span class="cm">   **/</span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="nf">UnsetReceiveHandler</span><span class="p">();</span>
<span class="w">   </span><span class="cm">/*</span>
<span class="cm">   * Setting a subscription state change handler, which gets called by the Communication</span>
<span class="cm">     Management implementation as soon as the subscription state of this event has changed.</span>
<span class="cm">   * Communication Management implementation will serialize calls to the registered handler.</span>
<span class="cm">     If multiple changes of the subscription state take place during the runtime of a</span>
<span class="cm">   * previous call to a handler, the Communication Management aggregates all changes to one</span>
<span class="cm">     call with the last/effective state.</span>
<span class="cm">   * Handler may be overwritten during runtime.</span>
<span class="cm">   *</span>
<span class="cm">   **/</span>
<span class="w">   </span><span class="kt">void</span><span class="w">  </span><span class="nf">SetSubscriptionStateChangeHandler</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="w"> </span><span class="n">SubscriptionStateChangeHandler</span><span class="w">  </span><span class="n">handler</span><span class="p">);</span>
<span class="w">   </span><span class="cm">/*</span>
<span class="cm">   * Remove handler set by SetSubscriptionStateChangeHandler()</span>
<span class="cm">   **/</span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="nf">UnsetSubscriptionStateChangeHandler</span><span class="p">();</span>
<span class="w">   </span><span class="cm">/*</span>
<span class="cm">   * \brief Get new data from the Communication Management</span>
<span class="cm">     buffers and provide it in callbacks to the given callable f.</span>
<span class="cm">   * writing the samples into the cache.</span>
<span class="cm">   *</span>
<span class="cm">   * \pre BrakeEvent::Subscribe has been called before (and not be</span>
<span class="cm">     withdrawn by BrakeEvent::Unsubscribe)</span>
<span class="cm">   *</span>
<span class="cm">   * \param f</span>
<span class="cm">   * parblock</span>
<span class="cm">   * callback, which shall be called with new sample.</span>
<span class="cm">   *</span>
<span class="cm">   * This callable has to fulfill signature</span>
<span class="cm">   * void(ara::com::SamplePtr&lt;SampleType const&gt;)</span>
<span class="cm">   * \parblockend</span>
<span class="cm">   *</span>
<span class="cm">   * \param maxNumberOfSamples</span>
<span class="cm">   * \parblock</span>
<span class="cm">   * upper bound of samples to be fetched from middleware buffers.</span>
<span class="cm">   * Default value means &quot;no restriction&quot;, i.e. all newly arrived samples</span>
<span class="cm">   * are fetched as long as there are free sample slots.</span>
<span class="cm">   * \parblockend</span>
<span class="cm">   *</span>
<span class="cm">   * \return Result, which contains the number of samples,</span>
<span class="cm">   * which have been fetched and presented to user via calls to f or an</span>
<span class="cm">   * ErrorCode in case of error (e.g. precondition not fullfilled)</span>
<span class="cm">   */</span>
<span class="w">   </span><span class="n">template</span><span class="w"> </span><span class="o">&lt;</span><span class="n">typename</span><span class="w"> </span><span class="n">F</span><span class="o">&gt;</span>
<span class="w">   </span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">::</span><span class="n">Result</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetNewSamples</span><span class="p">(</span>
<span class="w">   </span><span class="n">F</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">f</span><span class="p">,</span>
<span class="w">   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">maxNumberOfSamples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">());</span>
<span class="w"> </span><span class="p">};</span>
</pre></div>
</div>
<section id="event-subscription-and-local-cache">
<h4><span class="section-number">4.6.8.1. </span>Event Subscription and Local Cache<a class="headerlink" href="#event-subscription-and-local-cache" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>The mere fact, that there exists a member of the event wrapper class inside the proxy instance does not mean, that the user gets instant access to events raised/sent out by service instance. First ‘subscribe’ for the event, in order to tell the Communication Management, that the application is now interested in receiving events. For that purpose the event wrapper class of ara::com provides below method:</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * brief The application expects the Communication Management to subscribe the event.</span>
<span class="cm"> *</span>
<span class="cm"> * ...</span>
<span class="cm"> *</span>
<span class="cm"> * \param policy Defines the update policy for the application local cache.</span>
<span class="cm"> * \param cacheSize Defines the size of the application local cache.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">Subscribe</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">maxSampleCount</span><span class="p">);</span>
</pre></div>
</div>
<p>This method expects a parameter maxSampleCount, This method expects a parameter maxSampleCount, which basically
informs Communication Management implementation, how many event samples the application intends to hold at
maximum. Therefore — with calling this method, you not only tell the Communication Management, that you now
are interested in receiving event updates, but you are at the same time setting up a “local cache” for those
events bound to the event wrapper instance with the given maxSampleCount.</p>
</section>
<section id="monitoring-event-subscription">
<h4><span class="section-number">4.6.8.2. </span>Monitoring Event Subscription<a class="headerlink" href="#monitoring-event-subscription" title="Link to this heading"></a></h4>
<p>The call to the Subscribe method is asynchronous by nature. This means that at the point in time Subscribe
returns, it is just the indication, that the Communication Management has accepted the order to care for subscription.</p>
<p>The subscription process itself may (most likely, but depends on the underlying IPC implementation) involve
the event provider side. Contacting the possibly remote service for setting up the subscription might take
some time.</p>
<p>So the binding implementation of the subscribe is allowed to return immediately after accepting the subscribe,
even if for instance the remote service instance has not yet acknowledged the subscription (in case the
underlying IPC would support mechanism like acknowledgment at all). If the user — after having called
Subscribe — wants to get feedback about the success of the subscription, he might call:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="cm">/**</span>
<span class="cm"> * \brief query current subscription state.</span>
<span class="cm"> *</span>
<span class="cm"> * \return current state of the subscription.</span>
<span class="cm"> */</span>
<span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">SubscriptionState</span><span class="w"> </span><span class="nf">GetSubscriptionState</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
</pre></div>
</div>
<p>In the case the underlying IPC implementation uses some mechanism like a subscription acknowledge from the
service side, then an immediate call to GetSubscriptionState after Subscribe may return kSubscriptionPending,
if the acknowledge has not yet arrived.</p>
<p>Otherwise—in case the underlying IPC implementation gets instant feedback, which is very likely for local
communication—the call might also already return kSubscribed.</p>
<dl class="simple">
<dt>If the user needs to monitor the subscription state, he has two possibilities:</dt><dd><ul class="simple">
<li><p>Polling via GetSubscriptionState</p></li>
<li><p>Registering a handler, which gets called, when the subscription state changes</p></li>
</ul>
</dd>
</dl>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="cm">/**</span>
<span class="cm"> * Setting a subscription state change handler, which shall get called by the Communication Management</span>
<span class="cm"> implementation as soon as the subscription state of this event has changed.</span>
<span class="cm"> *</span>
<span class="cm"> * Handler may be overwritten during runtime.</span>
<span class="cm"> */</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">SetSubscriptionStateChangeHandler</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">SubscriptionStateChangeHandler</span><span class="w"> </span><span class="n">handler</span><span class="p">);</span>
</pre></div>
</div>
<p>Here the user may register a handler function, which has to fulfill the following signature:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">SubscriptionState</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">kSubscribed</span><span class="p">,</span><span class="w"> </span><span class="n">kNotSubscribed</span><span class="p">,</span><span class="w"> </span><span class="n">kSubscriptionPending</span><span class="w"> </span><span class="p">};</span>
<span class="n">using</span><span class="w"> </span><span class="n">SubscriptionStateChangeHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="n">SubscriptionState</span><span class="p">)</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>Anytime the subscription state changes, the Communication Management implementation calls the registered
handler. A typical usage pattern for an application developer, who wants to get notified about latest
subscription state, would be to register a handler before the first call to Subscribe.</p>
<p>After having accepted the “subscribe order” the Communication Management implementation will call the handler
first with argument SubscriptionState.kSubscriptionPending and later as it gets acknowledgment from the
service side it will call the handler with argument SubscriptionState.kSubscribed.</p>
<p><strong>Again the note:</strong> If the underlying implementation does not support a subscribe acknowledgment from the service
side, the implementation could also skip the first call to the handler with argument
SubscriptionState.kSubscriptionPending and directly call it with argument SubscriptionState.kSubscribed.</p>
</section>
<section id="accessing-event-data-aka-samples">
<h4><span class="section-number">4.6.8.3. </span>Accessing Event Data — aka Samples<a class="headerlink" href="#accessing-event-data-aka-samples" title="Link to this heading"></a></h4>
<p>After you successfully subscribed to an event according to the previous chapters,how is the access to received
event data samples achieved? The event data, which is sent from the event emitter (service provider) to
subscribing proxy instances is in typical IPC implementations accumulated/queued in some buffers (e.g. kernel
buffers, special IPC implementation controlled shared memory regions, …). So there has to be taken an
explicit action, to get/fetch those event samples from those buffers, eventually deserialze it and and then
put them into the event wrapper class instance specific cache in form of a correct SampleType. The API to
trigger this action is GetNewSamples.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="cm">/**</span>
<span class="cm"> * \brief Get new data from the Communication Management buffers and provide it in callbacks to the given callable f.</span>
<span class="cm"> *</span>
<span class="cm"> * ....</span>
<span class="cm"> */</span>
<span class="n">template</span><span class="w"> </span><span class="o">&lt;</span><span class="n">typename</span><span class="w"> </span><span class="n">F</span><span class="o">&gt;</span>
<span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">::</span><span class="n">Result</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetNewSamples</span><span class="p">(</span>
<span class="n">F</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">f</span><span class="p">,</span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">maxNumberOfSamples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">());</span>
</pre></div>
</div>
<p>The API is a function template, due to the fact, that the first parameter f is a very flexible user provided
Callable, which has to fulfill the following singnature requirement: void(ara::com::SamplePtr&lt;SampleType const&gt;).</p>
<p>The second argument of type size_t controls the maximum number of event samples, that shall be fetched/deserialized
from the middleware buffers and then presented to the application in form of a call to f.</p>
<p>On a call to GetNewSamples(), the ara::com implementation checks first, whether the number of event samples held
by the application already exceeds the maximum number, which it had committed in the previous call to Subscribe().
If so, an ara::core::ErrorCode is returned. Otherwise ara::com implementation checks, whether underlying
buffers contain a new event sample and—if it’s the case—deserializes it into a sample slot and then calls the
application provided f with a SamplePtr pointing to this new event sample. This processing (checking for further
samples in the buffer and calling back the application provided callback f) is repeated until either:</p>
<blockquote>
<div><ul class="simple">
<li><p>There aren’t any new samples in the buffers.</p></li>
<li><p>There are further samples in the buffers, but the application provided maxNumberOfSamples argument in  call to GetNewSamples() has been reached.</p></li>
<li><p>There are further samples in the buffers, but the application already exceeds its maxSampleCount, which  it had committed in Subscribe().</p></li>
</ul>
</div></blockquote>
<p>Within the implementation of callback f, which the application/user provides, it can be decided, what to do with the passed SamplePtr argument (i.e. by eventually doing a deep inspection of the event data): Shall the new sample be “thrown away”, because it is not of interest or shall it be kept for later. To get an idea, what keeping/throwing away of event samples means, the semantics of the SamplePtr, which is the access/entry point to the event sample data has to be fully understood.</p>
<section id="polling-via-getsubscriptionstate">
<h5><span class="section-number">4.6.8.3.1. </span>Polling via GetSubscriptionState<a class="headerlink" href="#polling-via-getsubscriptionstate" title="Link to this heading"></a></h5>
<p>If the user — after having called Subscribe — wants to get feedback about the success of the subscription, he might call:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * brief query current subscription state.</span>
<span class="cm"> *</span>
<span class="cm"> * \return current state of the subscription.</span>
<span class="cm"> */</span>
<span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">SubscriptionState</span><span class="w"> </span><span class="nf">GetSubscriptionState</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="registering-a-handler-which-gets-called-when-the-subscription-state-changes">
<h5><span class="section-number">4.6.8.3.2. </span>Registering a handler, which gets called, when the subscription state changes<a class="headerlink" href="#registering-a-handler-which-gets-called-when-the-subscription-state-changes" title="Link to this heading"></a></h5>
<p>User register a handler function, for subscription state changes.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm">* Setting a subscription state change handler, which gets called by</span>
<span class="cm">the Communication Management implementation as soon</span>
<span class="cm">* as the subscription state of this event has changed.</span>
<span class="cm">* Handler may be overwritten during runtime.</span>
<span class="cm">*</span>
<span class="cm">**/</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">SetSubscriptionStateChangeHandler</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">SubscriptionStateChangeHandler</span><span class="w"> </span><span class="n">handler</span><span class="p">);</span>
</pre></div>
</div>
<p>Anytime the subscription state changes, the Communication Management implementation calls the registered handler.</p>
</section>
</section>
<section id="event-driven-vs-polling-based-access">
<h4><span class="section-number">4.6.8.4. </span>Event-Driven vs Polling-Based access<a class="headerlink" href="#event-driven-vs-polling-based-access" title="Link to this heading"></a></h4>
<p><strong>Polling-Based access</strong></p>
<ul class="simple">
<li><p>An explicit interaction needed with ara::com API by calling Update to fill the local event wrapper specific cache:</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm">* brief Fetch data from the Communication Management buffers and apply filter before</span>
<span class="cm">* writing the samples into the cache.</span>
<span class="cm">*</span>
<span class="cm">* \pre BrakeEvent::Subscribe has been called before (and not be withdrawn by BrakeEvent::Unsubscribe)</span>
<span class="cm">* \param filter</span>
<span class="cm">*  parblock</span>
<span class="cm">* FilterFunction for the samples.</span>
<span class="cm">*</span>
<span class="cm">* This filter will be applied to the deserialized data within the context of</span>
<span class="cm">* the update this function should return true if the sample is added to</span>
<span class="cm">* the cache.</span>
<span class="cm">* parblockend</span>
<span class="cm">*</span>
<span class="cm">* \return True if new values received and those values are NOT ALL filtered out,</span>
<span class="cm">* else false.</span>
<span class="cm">*</span>
<span class="cm">* \note If precondition is not fulfilled, middleware impl might raise an unchecked exception</span>
<span class="cm">* (e.g. NotSubscribed).</span>
<span class="cm">*/</span>
<span class="kt">bool</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">FilterFunction</span><span class="o">&lt;</span><span class="n">SampleType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{});</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The method takes an optional parameter of a user defined filter function.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">using</span><span class="w"> </span><span class="n">FilterFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">S</span><span class="o">&amp;</span><span class="w"> </span><span class="n">sample</span><span class="p">)</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the user provided filter function gets an event (sample) and has to return true after checking, if he wants the sample to be put into the local cache.</p></li>
<li><p>During Update(), the Communication Management calls the filter function for each event, which has arrived since the last call to Update().</p></li>
<li><p>Update returns true in case new events have been placed into the local cache by the call, false otherwise.</p></li>
<li><p>After filling event specific local cache with event-data via Update() user typically want access those events. This is done with the following API:</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * brief Get the container of the samples in the cache that was updated by the last call</span>
<span class="cm"> * of \see update.</span>
<span class="cm"> *</span>
<span class="cm"> * The container and referenced data is expected to be stable until update is</span>
<span class="cm"> * called again.</span>
<span class="cm"> *</span>
<span class="cm"> * \return Container of SamplePtr</span>
<span class="cm"> */</span>
<span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">SampleContainer</span><span class="o">&lt;</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">SamplePtr</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">SampleType</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">GetCachedSamples</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>User can call this method as many times as you want — as long as user do not call Update() in between, the returned collection will always be the same/stable, even if the service side has send out several new events.</p></li>
</ul>
<p><strong>Event-Driven</strong></p>
<p>If user explicitly want the Communication Management to notify application thereby issuing asynchronous context switches to application process by below API.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">SetReceiveHandler</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">EventReceiveHandler</span><span class="w"> </span><span class="n">handler</span><span class="p">);</span>
</pre></div>
</div>
<p>This API allows user to register a user defined callback, which the Communication Management has to call in case new event data is available since the last call to Update().</p>
</section>
<section id="buffering-strategies">
<h4><span class="section-number">4.6.8.5. </span>Buffering Strategies<a class="headerlink" href="#buffering-strategies" title="Link to this heading"></a></h4>
<p>The following figure sketches a simple deployment, where we have a service providing an event, for which two different local adaptive SWCs have subscribed through their respective ara::com proxies/event wrappers.</p>
<p>Both proxies have a local event cache. This is the cache, which gets filled via Update().</p>
<p>Service implementation sends its event data to a Communication Management buffer, which is apparently outside the process space of the service implementation</p>
<figure class="align-center" id="id40">
<img alt="../_images/Event_Buffering_Approaches.png" class="with-border" src="../_images/Event_Buffering_Approaches.png" />
<figcaption>
<p><span class="caption-text"><strong>Event Buffering Approaches</strong></span><a class="headerlink" href="#id40" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This buffer is owned by kernel or it is realized as a shared memory between communicating proxies and skeleton or owned by a separate binding implementation specific ‘demon’ process.</p>
<ul class="simple">
<li><p><strong>Kernel Space</strong></p></li>
<li><p><strong>Shared Memory</strong></p></li>
<li><p><strong>IPC-Demon Process</strong></p></li>
</ul>
</section>
</section>
<section id="methods">
<h3><span class="section-number">4.6.9. </span>Methods<a class="headerlink" href="#methods" title="Link to this heading"></a></h3>
<p>For each method the remote service provides, the proxy class contains a member of a method specific wrapper class.</p>
<p>In our example, we have two methods and the corresponding members have the name Calibrate (of type methods::Calibrate) and Adjust (of type methods::Adjust).</p>
<figure class="align-center" id="id41">
<img alt="../_images/Adjust_Method_Class.png" class="with-border" src="../_images/Adjust_Method_Class.png" />
<figcaption>
<p><span class="caption-text"><strong>Adjust Method Class</strong></span><a class="headerlink" href="#id41" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The return value of a call to a service method, which is not a “one-way method” is an ara::com::Future, where the template parameter is of the type of the inner struct, which aggregates all OUT-parameters of the method.</p>
<section id="one-way-or-fire-and-forget-methods">
<h4><span class="section-number">4.6.9.1. </span>One-Way or Fire-and-Forget Methods<a class="headerlink" href="#one-way-or-fire-and-forget-methods" title="Link to this heading"></a></h4>
<p>ara::com supports a special flavor of a method, which we call “one-way” or “fire-and-forget”.</p>
<p>Technically this is a method with only IN-params — no OUT-params and no raising of errors allowed.</p>
<p>The client/caller therefore gets no feedback at all, whether the server/callee has processed a “one-way” call or not.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">class</span><span class="w"> </span><span class="n">LogCurrentState</span><span class="w"> </span><span class="p">{</span>
<span class="n">public</span><span class="o">:</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">    * brief Operation will call the method.</span>
<span class="cm">    *</span>
<span class="cm">    * Using the operator the call will be made by the Communication Management.</span>
<span class="cm">    * It is a one-way method, so no feedback (return value/out-parameter) is given.</span>
<span class="cm">    */</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">operator</span><span class="p">()();</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="event-driven-vs-polling-access-to-method-results">
<h4><span class="section-number">4.6.9.2. </span>Event-Driven vs Polling access to method results<a class="headerlink" href="#event-driven-vs-polling-access-to-method-results" title="Link to this heading"></a></h4>
<section id="event-driven">
<h5><span class="section-number">4.6.9.2.1. </span>Event-Driven<a class="headerlink" href="#event-driven" title="Link to this heading"></a></h5>
<p>Event-Driven means, that the caller of the method (the application with the proxy instance) gets notified by the Communication Management implementation as soon as the method call result has arrived.</p>
<p>Event driven method call can be achieve with following ways:</p>
<ul class="simple">
<li><p><strong>1.future.get()</strong></p></li>
<li><p><strong>2.wait(), wait_for() or wait_until()</strong></p></li>
<li><p><strong>3.Registering a callback method via then()</strong></p></li>
</ul>
</section>
<section id="polling-access">
<h5><span class="section-number">4.6.9.2.2. </span>Polling access<a class="headerlink" href="#polling-access" title="Link to this heading"></a></h5>
<p>It is used in RT(real time) application.</p>
<p>ara::com::Future::is_ready() is used to poll the method whether the method call has been finished.</p>
<p>After ara::com::Future::is_ready() has returned true, it is guaranteed that the next call to ara::com::Future::get() will NOT block, but immediately return either the valid value or throw an exception in case of error</p>
</section>
</section>
</section>
<section id="canceling-method-result">
<h3><span class="section-number">4.6.10. </span>Canceling Method Result<a class="headerlink" href="#canceling-method-result" title="Link to this heading"></a></h3>
<p>There may be cases, where you already have called a service method via the ()- operator, which returned you an ara::com::Future, but you are not interested in the result anymore.</p>
<p>It could even be the case, that you already have registered a callback via ara::com::Future::then() for it. Instead of just let things go and ‘ignore’ the callback, you should tell the Communication Management explicitly.</p>
<p>This might free resources and avoid unnecessary processing load on the binding implementation level.</p>
<p>Telling that you are not interested in the method call result anymore is simply done by letting the ara::com::Future go out of scope, so that its destructor gets called.</p>
<p>Call of the dtor of the ara::com::Future is a signal to the binding implementation, that any registered callback for this future should not be called anymore, reserved/allocated memory for the method call result might be freed and event waiting mechanisms for the method result should be stopped.</p>
</section>
<section id="checked-exception-handling">
<h3><span class="section-number">4.6.11. </span>Checked Exception Handling<a class="headerlink" href="#checked-exception-handling" title="Link to this heading"></a></h3>
<p>Unchecked Exceptions might be thrown by any ara::com API call, whereas Checked Exceptions might be thrown only in the context of non “one-way/fire-and-forget” service interface method calls.</p>
<p>There are two types of Checked Exceptions, which might be thrown in the course of a service method call on the proxy side:</p>
<p>ServiceNotAvailableException:This is a direct subclass of std::exception and will be thrown by the middleware implementation, when it detects during processing of a method call, that the providing service instance has already stopped offering the service.</p>
<p>Subclasses of ara::com::ApplicationErrorException:which are defined on meta-model level for a specific service interface method as ApplicationError and which are created at the application level service provider (skeleton) side and transported to the caller (proxy) side.</p>
<p>If one of those Checked Exception types happens, it will always be thrown in the context of the ara::com::Future::Get() call.</p>
<p>Calibrate method may raise the two application errors CalibrationFailed and InvalidConfigString, which get transformed to subclasses of ara::com::ApplicationErrorException on ara::com API level:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">ara</span><span class="o">::</span><span class="nn">com</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">com</span><span class="o">::</span><span class="nn">mycompany</span><span class="o">::</span><span class="nn">division</span><span class="o">::</span><span class="nn">radarservice</span><span class="p">;</span>

<span class="n">Future</span><span class="o">&lt;</span><span class="n">Calibrate</span><span class="o">::</span><span class="n">Output</span><span class="o">&gt;</span><span class="w"> </span><span class="n">calibrateFuture</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Some code to acquire handle</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">    </span><span class="n">RadarServiceProxy</span><span class="w"> </span><span class="n">service</span><span class="p">(</span><span class="n">handle</span><span class="p">);</span>
<span class="w">    </span><span class="n">calibrateFuture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">service</span><span class="p">.</span><span class="n">Calibrate</span><span class="p">(</span><span class="n">myConfigString</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* Now we access the future (with potentially blocking) Get()</span>
<span class="cm">       and directly handle the 3 different checked exceptions, which</span>
<span class="cm">       might be raised. */</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">calibrateFuture</span><span class="p">.</span><span class="n">Get</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">ServiceNotAvailableException</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// React on service shut down ...</span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;RadarService not available anymore&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CalibrationFailed</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// React on Application Error &#39;CalibrationFailed&#39; ...</span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;RadarService calibration failed because: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getFailureText</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">InvalidConfigString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// React on Application Error &#39;InvalidConfigString&#39; ...</span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Oops, we called RadarService.Calibrate with invalid config string: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getInvalidConfig</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Current (valid) config is: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">getCurrentValidConfig</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// Go on doing something ...</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="fields">
<h3><span class="section-number">4.6.12. </span>Fields<a class="headerlink" href="#fields" title="Link to this heading"></a></h3>
<p>Conceptually a field has — unlike an event — a certain value at any time. That result in the following additions compared to an event:</p>
<blockquote>
<div><ul class="simple">
<li><p>if a subscribtion to a field has been done, “immediately” initial values are sent back to the subscriber in an event-like notification pattern.</p></li>
<li><p>the current field value can be queried via a call to a Get() method or could be updated via a Set() method.</p></li>
</ul>
</div></blockquote>
<p>Field concept is roughly an aggregation of an event with correlated get()/set() methods.</p>
<blockquote>
<div><ul class="simple">
<li><p>call Get() or Set() methods of the field with exactly the same mechanism as regular methods</p></li>
<li><p>access field update notifications in the form of events/event data, which are sent by the service instance our proxy is connected to with exactly the same mechanism as regular events</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id42">
<img alt="../_images/UpdateRateFieldClass.png" class="with-border" src="../_images/UpdateRateFieldClass.png" />
<figcaption>
<p><span class="caption-text"><strong>UpdateRate Field Class</strong></span><a class="headerlink" href="#id42" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="skeleton-class">
<h2><span class="section-number">4.7. </span>Skeleton Class<a class="headerlink" href="#skeleton-class" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>The Skeleton class is generated from the service interface description of the AUTOSAR meta model.</p></li>
<li><p>ara::com does standardize the interface of the generated Skeleton class.</p></li>
<li><p>The toolchain of an AP product vendor will generate a Skeleton implementation class exactly implementing this interface.</p></li>
<li><p>The generated Skeleton class is an abstract class. It cannot be instantiated directly, because it does not contain implementations of the service methods, which the service should provide.</p></li>
<li><p>Therefore the service implementer has to subclass the skeleton and provide the service method implementation within the subclass.</p></li>
</ul>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RadarServiceSkeleton</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Ctor taking instance identifier as parameter and having default request processing mode kEvent.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">RadarServiceSkeleton</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">InstanceIdentifier</span><span class="w"> </span><span class="n">instanceId</span><span class="p">,</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">MethodCallProcessingMode</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span>
<span class="w">                             </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">MethodCallProcessingMode</span><span class="o">::</span><span class="n">kEvent</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Ctor taking instance identifier container as parameter and having default request processing mode kEvent.</span>
<span class="cm">     This specifically supports multi-binding.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">RadarServiceSkeleton</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">InstanceIdentifierContainer</span><span class="w"> </span><span class="n">instanceIds</span><span class="p">,</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">MethodCallProcessingMode</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span>
<span class="w">                             </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">MethodCallProcessingMode</span><span class="o">::</span><span class="n">kEvent</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Ctor taking instance specifier as parameter and having default request processing mode kEvent.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">RadarServiceSkeleton</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">::</span><span class="n">InstanceSpecifier</span><span class="w"> </span><span class="n">instanceSpec</span><span class="p">,</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">MethodCallProcessingMode</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span>
<span class="w">                             </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">MethodCallProcessingMode</span><span class="o">::</span><span class="n">kEvent</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * skeleton instances are not copy constructible.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">RadarServiceSkeleton</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RadarServiceSkeleton</span><span class="o">&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * skeleton instances are not copy assignable.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">RadarServiceSkeleton</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RadarServiceSkeleton</span><span class="o">&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * The Communication Management implementer should care in his dtor implementation, that the functionality</span>
<span class="cm">     of StopOfferService() is internally triggered in case this service instance has been offered before. This</span>
<span class="cm">     is a convenient cleanup functionality.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="o">~</span><span class="n">RadarServiceSkeleton</span><span class="p">();</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Offer the service instance. method is idempotent - could be called repeatedly.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">OfferService</span><span class="p">();</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Stop Offering the service instance. method is idempotent - could be called repeatedly. If service instance</span>
<span class="cm">     gets destroyed - it is expected that the Communication Management implementation calls StopOfferService() internally.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">StopOfferService</span><span class="p">();</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * For all output and non-void return parameters an enclosing struct is generated, which contains non-void</span>
<span class="cm">     return value and/or out parameters.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">CalibrateOutput</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * For all output and non-void return parameters an enclosing struct is generated, which contains non-void</span>
<span class="cm">     return value and/or out parameters.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">AdjustOutput</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="n">success</span><span class="p">;</span>
<span class="w">        </span><span class="n">Position</span><span class="w"> </span><span class="n">effective_position</span><span class="p">;</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * This fetches the next call from the Communication Management and executes it. The return value is a ara::core::Future.</span>
<span class="cm">     In case of an Application Error, an ara::core::ErrorCode is stored in the ara::core::Promise from which the</span>
<span class="cm">     ara::core::Future is returned to the caller. Only available in polling mode.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">::</span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ProcessNextMethodCall</span><span class="p">();</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * \brief Public member for the BrakeEvent</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">events</span><span class="o">::</span><span class="n">BrakeEvent</span><span class="w"> </span><span class="n">BrakeEvent</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * \brief Public member for the UpdateRate</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">fields</span><span class="o">::</span><span class="n">UpdateRate</span><span class="w"> </span><span class="n">UpdateRate</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * The following methods are pure virtual and have to be implemented</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">::</span><span class="n">Future</span><span class="o">&lt;</span><span class="n">CalibrateOutput</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Calibrate</span><span class="p">(</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">configuration</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">::</span><span class="n">Future</span><span class="o">&lt;</span><span class="n">AdjustOutput</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Adjust</span><span class="p">(</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">Position</span><span class="o">&amp;</span><span class="w"> </span><span class="n">position</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">LogCurrentState</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<section id="instantiation">
<h3><span class="section-number">4.7.1. </span>Instantiation<a class="headerlink" href="#instantiation" title="Link to this heading"></a></h3>
<p>Deploy many different instances of the same type (and therefore same skeleton class) it is straightforward, that you have
to give an instance identifier upon creation. This identifier has to be unique. In the exception-less creation of a service
skeleton a static member function Preconstruct checks the provided identifier. The construction token is embedded in the
returned ara::core::Result if the identifierwas unique. Otherwise it returns ara::core:.ErrorCode.</p>
<p>If a new instance shall be created with the same identifier, the existing instance needs to be destroyed before.</p>
<p>Exactly for this reason the skeleton class (just like the proxy class) does neither support copy construction nor copy assignment! Otherwise two “identical” instances would exist for some time with the same instance identifier and routing of method calls would be non-deterministic.</p>
<p>The different variants of ctors regarding instance identifier definition reflect their different natures.</p>
<blockquote>
<div><ul class="simple">
<li><p>Variant with ara::com::InstanceIdentifier: Service instance will be created with exactly one binding specific instance identifier.</p></li>
<li><p>variant with ara::com::InstanceIdentifierContainer: Service instance will be created with bindings to multiple distinct instance identifiers. This is mentioned as “multi-binding” throughout.</p></li>
<li><p>variant with ara::core::InstanceSpecifier: Service instance will be created with bindings to the instance identifier(s) found after “service manifest” lookup with the given ara::core::InstanceSpecifier. Note, that this could also imply a “multi-binding” as the integrator could have mapped the given ara::core::InstanceSpecifier to multiple technical/binding specific instance identifiers within the “service manifest”.</p></li>
</ul>
</div></blockquote>
<p>The second parameter of the ctors of type ara::com::MethodCallProcessingMode has a default value.</p>
<p>Note: Directly after creation of an instance of the subclass implementing the skeleton, this instance will not be visible to potential consumers and therefore no method will be called on it. This is only possible after the service instance has been made visible with the OfferService API.</p>
</section>
<section id="offering-service-instance">
<h3><span class="section-number">4.7.2. </span>Offering Service instance<a class="headerlink" href="#offering-service-instance" title="Link to this heading"></a></h3>
<p>The skeleton provides the method <cite>OfferService()</cite>. After you — as an application developer for the service provider side — have instantiated your custom service implementation class and initialized/set up your instance to a state where it is now able to serve requests (method calls) and provide events to subscribing consumers, you will call this <cite>OfferService()</cite> method on your instance.</p>
<p>From this point in time, where you call it, method calls might be dispatched to your service instance — even if the call to <cite>OfferService()</cite> has not yet returned.</p>
<p>If you decide at a certain point (maybe due to some state changes) that you do not want to provide the service anymore, you call <cite>StopOfferService()</cite> on your instance. The contract here is: After <cite>StopOfferService()</cite> has returned, no further method calls will be dispatched to your service instance.</p>
<p>For sanity reasons <cite>ara::com</cite> has the requirement for the AP vendor’s implementation of the skeleton dtor that it internally does a <cite>StopOfferService()</cite> too if the instance is currently offered.</p>
<p>So “stop offer” needs only to be called on an instance that lives on, and during its lifetime, it switches between states where it is visible and provides its service and states where it does not provide the service.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">using</span><span class="w"> </span><span class="n">namespace</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Our implementation of the RadarService -</span>
<span class="cm"> * subclass of RadarServiceSkeleton</span>
<span class="cm"> */</span>
<span class="n">class</span><span class="w"> </span><span class="n">RadarServiceImpl</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// read instanceId from the command line</span>
<span class="w">    </span><span class="n">ara</span><span class="o">::</span><span class="n">core</span><span class="o">::</span><span class="n">string_view</span><span class="w"> </span><span class="n">instanceIdStr</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span><span class="n">RadarServiceImpl</span><span class="w"> </span><span class="n">myRadarService</span><span class="p">(</span><span class="n">InstanceIdentifier</span><span class="p">(</span><span class="n">instanceIdStr</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// do some service-specific initialization here ....</span>
<span class="w">    </span><span class="n">myRadarService</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// now the service instance is ready -&gt; make it visible/available</span>
<span class="w">    </span><span class="n">myRadarService</span><span class="p">.</span><span class="n">OfferService</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// go into some wait state in the main thread - waiting for AppExecMgr</span>
<span class="w">    </span><span class="c1">// signals or the like ....</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="polling-and-event-driven-processing-modes">
<h3><span class="section-number">4.7.3. </span>Polling and event-driven processing modes<a class="headerlink" href="#polling-and-event-driven-processing-modes" title="Link to this heading"></a></h3>
<p>The behavior of a skeleton instance is controlled by the second parameter of Skeleton class ctor, which is of type ara::com::MethodCallProcessingMode.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm">* Request processing modes for the service implementation side</span>
<span class="cm">* (skeleton).</span>
<span class="cm">*</span>
<span class="cm">* \note Should be provided by platform vendor exactly like this.</span>
<span class="cm">*/</span>
<span class="k">enum</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">MethodCallProcessingMode</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">kPoll</span><span class="p">,</span><span class="w"> </span><span class="n">kEvent</span><span class="p">,</span><span class="w"> </span><span class="n">kEventSingleThread</span><span class="w"> </span><span class="p">};</span>
</pre></div>
</div>
<p>That means the processing mode is set for the entire service instance (i.e. all its provided methods are affected) and is fix for the whole lifetime of the skeleton instance. The default value in the ctor is set to kEvent.</p>
<section id="polling-mode">
<h4><span class="section-number">4.7.3.1. </span>Polling Mode<a class="headerlink" href="#polling-mode" title="Link to this heading"></a></h4>
<p>If you set it to kPoll, the Communication Management implementation will not call any of the provided service methods asynchronously! If you want to process the next (assume that there is a queue behind the scenes, where incoming service method calls are stored) pending service-call, you have to call the following method on your service instance:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm">* This fetches the next call from the Communication Management and executes it.</span>
<span class="cm">* Only available in polling mode. In event mode it throws an exception.</span>
<span class="cm">*/</span>
<span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ProcessNextMethodCall</span><span class="p">();</span>
</pre></div>
</div>
<p>A simple use case for a typical RT application could be:</p>
<ul class="simple">
<li><p>RT application gets scheduled.</p></li>
<li><p>it calls ProcessNextMethodCall and registers a callback with ara::com::Future::then()</p></li>
<li><p>the callback is invoked after the service method called by the midleware corresponding to the outstanding request has finished.</p></li>
<li><p>in the callback the RT application decides, if there is enough time left for serving a subsequent service method. If so, it calls another ProcessNextMethodCall.</p></li>
</ul>
</section>
<section id="event-driven-mode">
<h4><span class="section-number">4.7.3.2. </span>Event-Driven Mode<a class="headerlink" href="#event-driven-mode" title="Link to this heading"></a></h4>
<p>If you set the processing mode to kEvent or kEventSingleThread, the Communication Management implementation will dispatch events asynchronously to the service method implementations at the time the service call from the service consumer comes in.</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>kEvent:</strong></dt><dd><ul>
<li><p>Communication Management implementation may call the service method implementations concurrently.</p></li>
<li><p>If at the same point in time one call to method Calibrate and two calls to method Adjust arrive from different service consumers, the Communication Management implementation is allowed to take three threads from its internal thread-pool and do those three calls for the two service methods concurrently.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>kEventSingleThread:</strong></dt><dd><ul>
<li><p>kEventSingleThread assures, that on the service instance only one service method at a time will be called by the Communication Management implementation.</p></li>
<li><p>That means, Communication Management implementation has to queue incoming service method call events for the same service instance and dispatch them one after the other.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
</section>
<section id="id1">
<h3><span class="section-number">4.7.4. </span>Methods<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>Service methods on the skeleton side are abstract methods, which have to be overwritten by the service implementation sub-classing the skeleton.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm">* For all output and non-void return parameters</span>
<span class="cm">* an enclosing struct is generated, which contains</span>
<span class="cm">* non-void return value and/or out parameters.</span>
<span class="cm">*/</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">AdjustOutput</span><span class="w"> </span><span class="p">{</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">success</span><span class="p">;</span>
<span class="n">Position</span><span class="w"> </span><span class="n">effective_position</span><span class="p">;</span>
<span class="p">};</span>
<span class="n">virtual</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">Future</span><span class="o">&lt;</span><span class="n">AdjustOutput</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Adjust</span><span class="p">(</span>
<span class="k">const</span><span class="w"> </span><span class="n">Position</span><span class="o">&amp;</span><span class="w"> </span><span class="n">position</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>The returned ara::com::Future contains a structure as template parameter, which aggregates all the OUT-parameters of the service call.</p>
<section id="raising-application-errors">
<h4><span class="section-number">4.7.4.1. </span>Raising Application Errors<a class="headerlink" href="#raising-application-errors" title="Link to this heading"></a></h4>
<p>Whenever on the implementation side of a service method, an ApplicationError according to the interface description is detected, the Checked Exception representing this ApplicationError simply has to be stored into the Promise, from which the Future is returned to the caller:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">using</span><span class="w"> </span><span class="n">namespace</span><span class="w"> </span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="p">;</span>
<span class="n">using</span><span class="w"> </span><span class="n">namespace</span><span class="w"> </span><span class="n">com</span><span class="o">::</span><span class="n">mycompany</span><span class="o">::</span><span class="n">division</span><span class="o">::</span><span class="n">radarservice</span><span class="p">;</span>

<span class="cm">/* Our implementation of RadarService */</span>
<span class="n">class</span><span class="w"> </span><span class="n">RadarServiceImpl</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">public</span><span class="w"> </span><span class="n">RadarServiceSkeleton</span><span class="w"> </span><span class="p">{</span>
<span class="n">public</span><span class="o">:</span>
<span class="w">    </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">CalibrateOutput</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Calibrate</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">configuration</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Promise</span><span class="o">&lt;</span><span class="n">CalibrateOutput</span><span class="o">&gt;</span><span class="w"> </span><span class="n">promise</span><span class="p">;</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">promise</span><span class="p">.</span><span class="n">get_future</span><span class="p">();</span>

<span class="w">        </span><span class="cm">/* We check the given configuration arg */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">checkConfigString</span><span class="p">(</span><span class="n">configuration</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="cm">/* Given arg is invalid: */</span>
<span class="w">            </span><span class="n">InvalidConfigString</span><span class="w"> </span><span class="nf">myError</span><span class="p">(</span><span class="n">configuration</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="o">-&gt;</span><span class="n">curValidConfig_</span><span class="p">));</span>
<span class="w">            </span><span class="n">promise</span><span class="p">.</span><span class="n">set_exception</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">make_exception_ptr</span><span class="p">(</span><span class="n">myError</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Do something if configuration is valid</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="cm">/* We return a future with a potentially set exception */</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">future</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="n">private</span><span class="o">:</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">checkConfigString</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">config</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">curValidConfig_</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example, the implementation of ‘Calibrate’ detects, that the given configuration string argument is invalid and sets the corresponding exception to the Promise.</p>
</section>
</section>
<section id="id2">
<h3><span class="section-number">4.7.5. </span>Events<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>On the skeleton side the service implementation is in charge of notifying about occurrence of an event.</p></li>
<li><p>The event wrapper class on the skeleton/event provider side looks obviously different than on the proxy/event consumer side.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">class</span><span class="w"> </span><span class="n">BrakeEvent</span><span class="w"> </span><span class="p">{</span>
<span class="n">public</span><span class="o">:</span>
<span class="cm">/*</span>
<span class="cm">* Shortcut for the events data type.</span>
<span class="cm">*/</span>
<span class="n">using</span><span class="w"> </span><span class="n">SampleType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RadarObjects</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">Send</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">SampleType</span><span class="w"> </span><span class="o">&amp;</span><span class="n">data</span><span class="p">);</span>
<span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">SampleAllocateePtr</span><span class="o">&lt;</span><span class="n">SampleType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Allocate</span><span class="p">();</span>
<span class="cm">/*</span>
<span class="cm">* After sending data you loose ownership and can’t access</span>
<span class="cm">* the data through the SampleAllocateePtr anymore.</span>
<span class="cm">* Implementation of SampleAllocateePtr will be with the</span>
<span class="cm">* semantics of std::unique_ptr (see types.h)</span>
<span class="cm">**/</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">Send</span><span class="p">(</span><span class="n">ara</span><span class="o">::</span><span class="n">com</span><span class="o">::</span><span class="n">SampleAllocateePtr</span><span class="o">&lt;</span><span class="n">SampleType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>ara::com provides two different variants of a ‘Send’ method, which is used to send out new event data.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The event data has been allocated somewhere by the service application developer and is given via reference to the binding implementation of Send(). After the call to send returns, the data might be removed/altered on the caller side. The binding implementation will make a copy in the call.</p></li>
<li><p>The second variant of ‘Send’ also has a parameter named ‘data’, but this is now of a different type ara::com::SampleAllocateePtr&lt;SampleType&gt;. ara::com introduced here, will behave like a std::unique_ptr&lt;T&gt;.Only one party can hold the pointer - if the owner wants to give it away, he has to explicitly do it via std::move.</p></li>
<li><p>ara::com::SampleAllocateePtr&lt;SampleType&gt; Allocate();</p></li>
</ol>
<ul class="simple">
<li><p>The event wrapper class provides us here with a method to allocate memory for one sample of event data.</p></li>
<li><p>It returns a smart pointer ara::com::SampleAllocateePtr&lt;SampleType&gt;, which points to the allocated memory, where we then can write an event data sample to.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id3">
<h3><span class="section-number">4.7.6. </span>Fields<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<p>On the skeleton side the service implementation is in charge of</p>
<ul class="simple">
<li><p>updating and notifying about changes of the value of a field.</p></li>
<li><p>serving incoming Get() calls.</p></li>
<li><p>serving incoming Set() calls.</p></li>
</ul>
<p>The field wrapper class on the skeleton/field provider side looks obviously different than on the proxy/field consumer side.</p>
<figure class="align-center" id="id43">
<img alt="../_images/UpdateRateClass.png" class="with-border" src="../_images/UpdateRateClass.png" />
<figcaption>
<p><span class="caption-text"><strong>UpdateRate Class</strong></span><a class="headerlink" href="#id43" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="registering-getters">
<h4><span class="section-number">4.7.6.1. </span>Registering Getters<a class="headerlink" href="#registering-getters" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>The RegisterGetHandler method provides the possibility to register a method implementation by the service implementer, which gets then called by the binding implementation on an incoming Get() call from any proxy instance.</p></li>
<li><p>The RegisterGetHandler method in the generated skeleton does only exist in case availability of “field getter” has been configured for the field in the configuration.</p></li>
</ul>
</section>
<section id="registering-setters">
<h4><span class="section-number">4.7.6.2. </span>Registering Setters<a class="headerlink" href="#registering-setters" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>RegisterSetHandler API has to be called by the service implementer in case field has been configured with setter support.</p></li>
</ul>
</section>
</section>
</section>
<section id="service-discovery-implementation-strategies">
<h2><span class="section-number">4.8. </span>Service Discovery Implementation Strategies<a class="headerlink" href="#service-discovery-implementation-strategies" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>As the service discovery functionality is basically defined at the API level with the methods for FindService, OfferService and StopOfferService.</p></li>
<li><p>When an AP node (more concretely an AP SWC) offers a service over the network or requires a service from another network node, then service discovery/service registry obviously takes place over the wire.</p></li>
<li><p>The protocol for service discovery over the wire needs to be completely specified by the used communication protocol.</p></li>
<li><p>if an ara::com application wants to communicate with another ara::com application on the same node within the AP of the same vendor there has to be a local variant of a service discovery available.</p></li>
</ul>
<section id="central-vs-distributed-approach">
<h3><span class="section-number">4.8.1. </span>Central vs Distributed approach<a class="headerlink" href="#central-vs-distributed-approach" title="Link to this heading"></a></h3>
<section id="central-approach">
<h4><span class="section-number">4.8.1.1. </span>Central approach<a class="headerlink" href="#central-approach" title="Link to this heading"></a></h4>
<p>This approach have one central entity(a demon process), which:
- maintains a registry of all service instances together with their location information
- serves all FindService, OfferService and StopOfferService requests from local ara::com applications, thereby either updating the registry (OfferService, StopOfferService) or querying the registry ( FindService)
- serves all SOME/IP SD messages from the network either updating its registry (SOME/IP Offer Service received) or querying the registry (SOME/IP Find Service received)</p>
<figure class="align-center" id="id44">
<img alt="../_images/Centralized_discovery_approach.png" class="with-border" src="../_images/Centralized_discovery_approach.png" />
<figcaption>
<p><span class="caption-text"><strong>Centralized discovery approach</strong></span><a class="headerlink" href="#id44" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="distributed-approach">
<h4><span class="section-number">4.8.1.2. </span>Distributed approach<a class="headerlink" href="#distributed-approach" title="Link to this heading"></a></h4>
<p>This approach would be, to distribute the service registry information (availability and location information) among the ara::com applications within the node.So for the node local communication use case no prominent discovery demon would be needed.</p>
<figure class="align-center" id="id45">
<img alt="../_images/Distributed_discovery_approach.png" class="with-border" src="../_images/Distributed_discovery_approach.png" />
<figcaption>
<p><span class="caption-text"><strong>Distributed discovery approach</strong></span><a class="headerlink" href="#id45" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="multi-binding-implications">
<h3><span class="section-number">4.8.2. </span>Multi-Binding implications<a class="headerlink" href="#multi-binding-implications" title="Link to this heading"></a></h3>
<ul>
<li><p>Multi-Binding describes the solution to support setups, where the technical transport/connection between different instances of a certain proxy class/skeleton class are different.</p>
<blockquote>
<div><ul class="simple">
<li><p>proxy class uses different transport/IPC to communicate with different skeleton instances. Reason: Different service instances support different transport mechanisms because of deployment decisions.</p></li>
<li><p>symmetrically it may also be the case, that different proxy instances for the same skeleton instance uses different transport/IPC to communicate with this instance: The skeleton instance supports multiple transport mechanisms to get contacted.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<section id="simple-multi-binding-use-case">
<h4><span class="section-number">4.8.2.1. </span>Simple Multi-Binding use case<a class="headerlink" href="#simple-multi-binding-use-case" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>The following figure depicts an obvious and/or rather simple case. In this example, which only deals with node local (inside one AP product/ECU) communication between service consumers (proxy) and service providers (skeleton), there are two instances of the same proxy class on the service consumer side.</p></li>
<li><p>Service consumer application has triggered a ‘FindService’ first, which returned two handles for two different service instances of the searched service type.</p></li>
<li><p>The service consumer application has instantiated a proxy instance for each of those handles.</p></li>
<li><p>Now in this example the instance 1 of the service is located inside the same adaptive application (same process/address space) as the service consumer (proxy instance 1), while the service instance 2 is located in a different adaptive application (different process/ address space).</p></li>
</ul>
<figure class="align-center" id="id46">
<img alt="../_images/Simple_MultiBinding_intra_example.png" class="with-border" src="../_images/Simple_MultiBinding_intra_example.png" />
<figcaption>
<p><span class="caption-text"><strong>Simple MultiBinding intra example</strong></span><a class="headerlink" href="#id46" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="local-network-multi-binding-use-case">
<h4><span class="section-number">4.8.2.2. </span>Local/Network Multi-Binding use case<a class="headerlink" href="#local-network-multi-binding-use-case" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>After we have seen a special variant of Multi-Binding in the preceding section, we now look at a variant, which can also be considered as being a real-world case.</p></li>
<li><p>The instance 2 of the service is located on a different ECU attached to the same Ethernet network as our ECU with the AP product, where the service consumer (with its proxies for instance 1 and 2) resides.</p></li>
<li><p>As the standard protocol on Ethernet for AP is SOME/IP, it is expected, that the communication between both ECUs is based on SOME/IP.</p></li>
<li><p>For our concrete example this means, that proxy 1 talks to service 1 via unix domain sockets (which might be optimized for process local communication to direct method calls), while the proxy 2 talks to service 2 via network sockets in a SOME/IP compliant message format.</p></li>
</ul>
<p>Multi-Binding_local_and_network_example</p>
<figure class="align-center" id="id47">
<img alt="../_images/Multi-Binding_local_and_network_example.png" class="with-border" src="../_images/Multi-Binding_local_and_network_example.png" />
<figcaption>
<p><span class="caption-text"><strong>Multi-Binding local and network example</strong></span><a class="headerlink" href="#id47" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="typical-some-ip-multi-binding-use-case">
<h4><span class="section-number">4.8.2.3. </span>Typical SOME/IP Multi-Binding use case<a class="headerlink" href="#typical-some-ip-multi-binding-use-case" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>It is highly unlikely that an adaptive SWC (i.e. the language and network binding which runs in its context) opens socket connections itself to communicate with a remote service.</p></li>
<li><p>SOME/IP was explicitly designed to use as few ports as possible.</p></li>
<li><p>The reason for that requirement comes from low power/low resources embedded ECUs:</p></li>
<li><p>Managing a huge amount of IP sockets in parallel means huge costs in terms of memory (and runtime) resources.</p></li>
<li><p>AUTOSAR CP siblings which will be main communication partner in an inside vehicle network demand this approach, which is uncommon, compared to non-automotive IT usage pattern for ports.</p></li>
<li><p>The entire SOME/IP traffic of an ECU / network endpoint is routed through one IP port!</p></li>
<li><p>That means SOME/IP messages originating from/dispatched to many different local applications (service providers or service consumers) are (de)multiplexed to/from one socket connection.</p></li>
<li><p>POSIX compatible OS with POSIX socket API, multiplexing SOME/IP communication of many applications to/from one port means the introduction of a separate/central (demon) process, which manages the corresponding port.</p></li>
<li><p>The task of this process is to bridge between SOME/IP network communication and local communication and vice versa.</p></li>
</ul>
<figure class="align-center" id="id48">
<img alt="../_images/SOMEIPBridge.png" class="with-border" src="../_images/SOMEIPBridge.png" />
<figcaption>
<p><span class="caption-text"><strong>SOME/IP Bridge</strong></span><a class="headerlink" href="#id48" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
</section>
<section id="ara-com-and-autosar-meta-model-relationship">
<h2><span class="section-number">4.9. </span>ara::com and AUTOSAR meta-model relationship<a class="headerlink" href="#ara-com-and-autosar-meta-model-relationship" title="Link to this heading"></a></h2>
<section id="service-interface">
<h3><span class="section-number">4.9.1. </span>Service Interface<a class="headerlink" href="#service-interface" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Service Interface defines everything signaturewise of an ara::com proxy or skeleton.</p></li>
<li><p>The ServiceInterface describes the methods, fields and the methods a service interface consists of and how the signatures of those elements (arguments and data types) look like.</p></li>
<li><p>ara::com proxy and skeleton classes get generated from ServiceInterface.</p></li>
</ul>
</section>
<section id="software-component">
<h3><span class="section-number">4.9.2. </span>Software Component<a class="headerlink" href="#software-component" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The idea of a software component is to describe a reusable part of software with well defined interfaces.</p></li>
<li><p>AUTOSAR manifest specification defines a model element SoftwareComponentType, which is an abstract element with several concrete subtypes, of which the subtype AdaptiveApplicationSwComponentType is the most important one for Adaptive Application software developers.</p></li>
</ul>
<figure class="align-center" id="id49">
<img alt="../_images/meta-model_to_Implementation.png" class="with-border" src="../_images/meta-model_to_Implementation.png" />
<figcaption>
<p><span class="caption-text"><strong>meta-model to Implementation</strong></span><a class="headerlink" href="#id49" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>SoftwareComponentTypes A and B from the example in the upper part (meta-model level) a concrete implementation exists on implementation level (lower part in the figure).</p></li>
<li><p>The realization/implementation of R-Port of SoftwareComponentType A is based on an instance of ara::com proxy class on implementation level, while the P-Port implementation of SoftwareComponentType B is using an instance of ara::com skeleton class.</p></li>
<li><p>Proxy and skeleton class are generated from the service interface definition ServiceInterface, which is referenced by the corresponding ports.</p></li>
<li><p>Such a code fragment, which realizes a SoftwareComponentType can obviously be re-used. On C++ implementation level an implementation of an AdaptiveApplicationSwComponentType typically boils down to one or several C++ classes. So re-use simply means instantiating this class/those classes in different contexts multiple times.</p></li>
</ul>
<figure class="align-center" id="id50">
<img alt="../_images/Multiple_Instantiation_in_Implementation_contexts.png" class="with-border" src="../_images/Multiple_Instantiation_in_Implementation_contexts.png" />
<figcaption>
<p><span class="caption-text"><strong>Multiple Instantiation in Implementation Contexts</strong></span><a class="headerlink" href="#id50" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="adaptive-application-executables-and-processes">
<h3><span class="section-number">4.9.3. </span>Adaptive Application/Executables and Processes<a class="headerlink" href="#adaptive-application-executables-and-processes" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Deployable software units within AP are so called Adaptive Applications (the corresponding meta-model element is AdaptiveAutosarApplication).</p></li>
<li><p>Such an Adaptive Application consists of 1..n executeables</p></li>
</ul>
<figure class="align-center" id="id51">
<img alt="../_images/Instantiation_of_Adaptive_Applications_in_Deployment.png" class="with-border" src="../_images/Instantiation_of_Adaptive_Applications_in_Deployment.png" />
<figcaption>
<p><span class="caption-text"><strong>Instantiation of Adaptive Applications in Deployment</strong></span><a class="headerlink" href="#id51" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Abstract identifiers relate in a certain way to the corresponding port in the model of the SoftwareComponentType.</p></li>
<li><p>Instance IDs obviously have to be assigned to objects, which finally have a distinct identity in an deployment.</p></li>
</ul>
<figure class="align-center" id="id52">
<img alt="../_images/Example_of_the_possible_structure_of_an_Executable.png" class="with-border" src="../_images/Example_of_the_possible_structure_of_an_Executable.png" />
<figcaption>
<p><span class="caption-text"><strong>Example of the possible structure of an Executable</strong></span><a class="headerlink" href="#id52" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="usage-of-meta-model-identifiers-within-ara-com-based-application-code">
<h3><span class="section-number">4.9.4. </span>Usage of meta-model identifiers within ara::com based application code<a class="headerlink" href="#usage-of-meta-model-identifiers-within-ara-com-based-application-code" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The abstract identifiers relate in a certain way to the corresponding port in the model of the SoftwareComponentType.</p></li>
<li><p>Port name of the model alone isn’t sufficient to clearly identify it in its final instantiation, where the same component implementation might be instantiated multiple times in the code and then eventually started multiple times in different processes.</p></li>
<li><p>Instance IDs obviously have to be assigned to objects, which finally have a distinct identity in an deployment.</p></li>
</ul>
<figure class="align-center" id="id53">
<img alt="../_images/InstanceIds_in_Deployment.png" class="with-border" src="../_images/InstanceIds_in_Deployment.png" />
<figcaption>
<p><span class="caption-text"><strong>InstanceIds in Deployment</strong></span><a class="headerlink" href="#id53" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul>
<li><p>The figure above shows, within Executable 2 there are three instantiations of SoftwareComponentType B implementation in different contexts (nesting levels).All instances do provide a specific instance of SI RadarService.</p></li>
<li><p>The integrator, who applies the Service Instance Manifest for Process 2 has to do the technical mapping on ara::com level. I.e. he has to decide, which technical transport binding is to be used in each of the B instantiations and subsequently also, which technical transport binding specific instance ID.</p></li>
<li><p>In our example, the integrator wants to provide the SI RadarService via SOME/IP binding and an SOME/IP specific instance ID “1” in the context of the B instantiation, which is nested inside the composite component on the right side, while he decides to provide the SI RadarService via local IPC (Unix domain socket) binding and a Unix domain socket specific instance ID “/tmp/Radar/3” and “/tmp/Radar/4” in the context of the B instantiations on the left side, which are not nested.</p></li>
<li><p>Within the Service Instance Manifest, which allows to specify the mapping of port instantiations within a Process to technical bindings and their concrete instance IDs, the sole usage of the port name from the model isn’t sufficient to differentiate.</p></li>
<li><p>To get unique identifiers within an executable (and therefore a process), the nature of nested instantiation and re-use of SoftwareComponentTypes has to be considered. Every time a SoftwareComponentType gets instantiated, its instantiation gets a unique name within its instantiation context.</p></li>
<li><p>In our example this means:</p>
<blockquote>
<div><ul class="simple">
<li><p>B instantiations on top level get unique names on their level: “B_Inst_1” and “B_Inst_2”</p></li>
<li><p>B instantiation within the Composite Component Type gets unique name on this level: “B_Inst_1”</p></li>
<li><p>Composite Component instantiation on top level gets unique name on its level: “Comp_Inst_1”</p></li>
<li><p>From the perspective of the executable/process, we therefore have unique identifiers for all instances of B:</p>
<ul>
<li><p>“B_Inst_1”</p></li>
<li><p>“B_Inst_2”</p></li>
<li><p>“Comp_Inst_1::B_Inst_1”</p></li>
</ul>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
</section>
<section id="serialization">
<h2><span class="section-number">4.10. </span>Serialization<a class="headerlink" href="#serialization" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Serialization is the process of transforming certain data structures into a standardized format for exchange between a sender and a (possibly different) receiver.</p></li>
<li><p>When putting data on the wire and reading it back, receiver have to follow exact, agreed-on rules to be able to correctly interpret the data on the receiver side.</p></li>
<li><p>For Adaptive Platform, the loading of executables during runtime, which have been built independently at different times and have been uploaded to an AP ECU at different times, is definitely a supported use case. The chance, that compiler settings for different ara::com applications were different regarding alignment decisions is consequently high. Therefore an AP product (more concrete its IPC binding implementation) has to use/support serialization of exchanged event/field/method data.</p></li>
</ul>
<section id="zero-copy-implications">
<h3><span class="section-number">4.10.1. </span>Zero-Copy implications<a class="headerlink" href="#zero-copy-implications" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>One thing which typically is at the top of the list of performance optimizations in IPC/middleware implementations is the avoidance of unnecessary copies between sender and the receiver of data.</p></li>
<li><p>When we talk about AP, where we have architectural expectations like applications running in separate processes providing memory protection, the typical communication approach needs at least ONE copy of the data from source address space to target address space.</p></li>
<li><p>Highly optimizing middleware/IPC implementations could even get rid of this single copy step by setting up shared memory regions between communicating ara::com components(sender and receiver).</p></li>
</ul>
</section>
</section>
<section id="ara-rest">
<h2><span class="section-number">4.11. </span>ARA REST<a class="headerlink" href="#ara-rest" title="Link to this heading"></a></h2>
<section id="what-is-rest">
<h3><span class="section-number">4.11.1. </span>1. What is REST ?<a class="headerlink" href="#what-is-rest" title="Link to this heading"></a></h3>
<p>REpresentational State Transfer (REST) is a stateless client-server architecture in which the web services are viewed as resources offered by server and can be identified by their URIs. Web service clients that want to use these resources access via globally defined set of remote methods like GET, PUT etc, that describe the action to be performed on the resource. It consists of two components REST server which provides access to the resources and a REST client which accesses and modify the REST resources. In the REST architecture style, clients and servers exchange representations of resources by using a standardized interface and protocol.REST isn’t protocol specific, but REST works over HTTP. The response from server is considered as the representation of the resources. This representation can be generated from one resource or more number of resources. It enables web applications that are built on various programming languages to communicate with each other. With the help of Restful services, these web applications can reside on different environments, some could be on Windows, and others could be on Linux.</p>
<figure class="align-center" id="id54">
<img alt="../_images/REST_Overview.png" class="with-border" src="../_images/REST_Overview.png" />
<figcaption>
<p><span class="caption-text"><strong>REST Overview</strong></span><a class="headerlink" href="#id54" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>REST is Representational State Transfer (REST) architectural style.</p></li>
<li><p>Architecture style for networked systems, it is not a protocol nor a standard.</p></li>
<li><p>Relies on other standards like HTTP, JSON, etc.</p></li>
<li><p>Protocol, language and platform independent which makes it very flexible.</p></li>
<li><p>Client-Server architecture just like the web.</p></li>
<li><p>With REST, networked components are a resource you request access to whose implementation details are unclear.</p></li>
</ul>
<section id="key-properties-of-rest-api">
<h4><span class="section-number">4.11.1.1. </span>Key Properties of REST API<a class="headerlink" href="#key-properties-of-rest-api" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Client-Server :</strong></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>The client-server architecture is a fairly well-known and widely used architecture. Most network based applications work in this manner.</p></li>
<li><p>The architecture consists of a server that acts as a central point where one or many clients may interact.</p></li>
<li><p>The idea behind a client-server architecture is that the server does the heavy lifting and orchestration required, whilst the client consumes the rich data and functionality by interacting with the server.</p></li>
<li><p>When these computers communicate with each other, there’s a clear need for a common protocol that is understood and supported by both parties.</p></li>
<li><p>The commonality required is the message format. By separating the user interface concerns from the data storage concerns, the portability of the user interface across multiple platforms is improved and also improve the scalibilty by simplifying the server components.</p></li>
<li><p>The separation also allows the components to evolve independently</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id55">
<img alt="../_images/REST_Client_Server.png" class="with-border" src="../_images/REST_Client_Server.png" />
<figcaption>
<p><span class="caption-text"><strong>REST Client-Server</strong></span><a class="headerlink" href="#id55" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p><strong>Stateless :</strong></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>A vast majority of web applications make use of a server-side managed session to keep track of a specific client.</p></li>
<li><p>These sessions are often used for auth (authentication and authorization), keeping track of context, and storing meta data in memory that may be useful for managing the user’s activity.</p></li>
<li><p>This makes scaling difficult as additional technologies and development is required to create session management servers in a clustered environment.</p></li>
<li><p>The stateless architecture removes the need for the server to create and hold sessions.</p></li>
<li><p>In a stateless architecture, Communication must be stateless in nature, such that each request from client to server must contain all of the information necessary to understand the request and cannot take advantage of any stored context on the server.</p></li>
<li><p>The disadvantage is that it may decrease network performance by increasing the repetitive data sent in a series of request.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id56">
<img alt="../_images/REST_Stateless.png" class="with-border" src="../_images/REST_Stateless.png" />
<figcaption>
<p><span class="caption-text"><strong>REST Stateless</strong></span><a class="headerlink" href="#id56" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p><strong>Cache :</strong></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>In order to improve network efficiency, we add cache constraints to form the client-cache-stateless-server.</p></li>
<li><p>The cacheable architecture is the concept of cleverly caching data that is used often, and changed infrequently.</p></li>
<li><p>Caching may occur in places like the client browser, and a caching server.</p></li>
<li><p>Caching mechanisms are expected to be smart enough to serve cached data or resources until that piece of data or resource changes for the client requesting it.</p></li>
<li><p>One of the advantages of caching is a reduced load on the network, this translates to reduction of unnecessary requests, lower data usage, and a more optimal performing application.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id57">
<img alt="../_images/REST_Cache.png" class="with-border" src="../_images/REST_Cache.png" />
<figcaption>
<p><span class="caption-text"><strong>REST Cache</strong></span><a class="headerlink" href="#id57" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p><strong>Uniform Interface :</strong></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>The concept of a uniform interface includes creating a standard method of interacting with a system.</p></li>
<li><p>The uniform interface architecture also promotes abstraction of the implementation from the interface definition.</p></li>
<li><p>This allows for clients to interact with all services in the same way, using a standard protocol and message format with a well defined set of operations.</p></li>
<li><p>The central feature that distinguishes the REST architectural style from other network-based styles is its emphasis on a uniform interface between components</p></li>
<li><p>Implementations are decoupled from the services they provide, which encourages independent evolvability.</p></li>
<li><p>The trade-off, though, is that a uniform interface degrades efficiency, since information is transferred in a standardized form rather than one which is specific to an application’s needs.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id58">
<img alt="../_images/REST_Uniform_Interface.png" class="with-border" src="../_images/REST_Uniform_Interface.png" />
<figcaption>
<p><span class="caption-text"><strong>REST Uniform Interface</strong></span><a class="headerlink" href="#id58" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p><strong>Layered System :</strong></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>The layered architecture is utilised for a number of different factors.</p></li>
<li><p>A layered approach allows developers to separate concerns and loosely couple components that interact with each other.</p></li>
<li><p>The advantage of this approach when implemented optimally is that layers may change independently without impacting the rest of the application.</p></li>
<li><p>There are also cases where a layered architecture may consist of a layer that is shared across multiple other layers.</p></li>
<li><p>The layered system style allows an architecture to be composed of hierarchical layers by constraining component behavior.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id59">
<img alt="../_images/REST_Layered_system.png" class="with-border" src="../_images/REST_Layered_system.png" />
<figcaption>
<p><span class="caption-text"><strong>REST Layered system</strong></span><a class="headerlink" href="#id59" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
</section>
<section id="ara-rest-architectural-elements">
<h2><span class="section-number">4.12. </span>ARA::REST Architectural Elements<a class="headerlink" href="#ara-rest-architectural-elements" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>ARA::REST is a web standard based architecture and uses HTTP Protocol for data communication with help of POCO library.</p></li>
<li><p>A resource is accessed by a common interface using HTTP standard methods like GET, PUT, DELETE etc.</p></li>
<li><p>In ARA::REST architecture, a ARA::REST Server simply provides access to resources Object graph model and the ARA::REST client accesses and presents the resources.</p></li>
<li><p>Here each resource is identified by URIs/ Global IDs.</p></li>
<li><p>ARA::REST uses various representations to represent a resource like Text, JSON and XML.</p></li>
<li><p>ARA::REST is an API framework, which has components like Object Graph, Messages, Router, URI, Client, Server.</p></li>
<li><p>All transport protocol bindings must map to basic set of components.</p></li>
</ul>
<figure class="align-center" id="id60">
<img alt="../_images/ARA_Rest_components.png" class="with-border" src="../_images/ARA_Rest_components.png" />
<figcaption>
<p><span class="caption-text"><strong>ARA Rest components</strong></span><a class="headerlink" href="#id60" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id61">
<img alt="../_images/RESTful.png" class="with-border" src="../_images/RESTful.png" />
<figcaption>
<p><span class="caption-text"><strong>RESTful</strong></span><a class="headerlink" href="#id61" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>The following HTTP methods are most commonly used in a REST based architecture.</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><strong>GET</strong> − Provides a read only access to a resource.</p></li>
<li><p><strong>PUT</strong> − Used to create a new resource.</p></li>
<li><p><strong>DELETE</strong> − Used to remove a resource.</p></li>
<li><p><strong>POST</strong> − Used to update an existing resource or create a new resource.</p></li>
<li><p><strong>OPTIONS</strong> − Used to get the supported operations on a resource.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>The ARA::Rest elements are as follows:</p></li>
</ul>
<p><strong>Resources</strong>:</p>
<blockquote>
<div><ul class="simple">
<li><p>ARA::REST architecture treats every content as a resource. These resources can be Text Files, Html Pages, Images, Videos or Dynamic Business Data.</p></li>
<li><p>ARA::REST Server simply provides access to resources and ARA::REST client accesses and modifies the resources.</p></li>
<li><p>Here each resource is identified by URIs/ Global IDs. ARA::REST uses various representations to represent a resource which can be Text, JSON, XML.</p></li>
<li><p>The most popular representations of resources are XML and JSON.</p></li>
<li><p>A resource in ARA::REST is a similar to an Object in Object Oriented Programming or is like an Entity in a Database.</p></li>
<li><p>Once a resource is identified then its representation is to be decided using a standard format so that the server can send the resource in the above said format and client can understand the same format.</p></li>
</ul>
</div></blockquote>
<p><strong>Messages</strong>:</p>
<blockquote>
<div><ul class="simple">
<li><p>RESTful make use of HTTP protocols as a medium of communication between client and server.</p></li>
<li><p>A client sends a message in form of a HTTP Request and the server responds in the form of an HTTP Response.</p></li>
<li><p>This technique is termed as Messaging. These messages contain message data and metadata i.e. information about message itself.</p></li>
</ul>
</div></blockquote>
<p>Message are of following types:</p>
<blockquote>
<div><p><strong>HTTP Request</strong></p>
<blockquote>
<div><p>An HTTP Request has five major parts :</p>
<ul class="simple">
<li><p><strong>Verb</strong> − Indicates the HTTP methods such as GET, POST, DELETE, PUT, etc.</p></li>
<li><p><strong>URI</strong> − Uniform Resource Identifier (URI) to identify the resource on the server.</p></li>
<li><p><strong>HTTP Version</strong> − Indicates the HTTP version. For example, HTTP v1.1.</p></li>
<li><p><strong>Request Header</strong> − Contains metadata for the HTTP Request message as key-value pairs. For example, client (or browser) type, format supported by the client, format of the message body, cache settings, etc.</p></li>
<li><p><strong>Request Body</strong> − Message content or Resource representation.</p></li>
</ul>
</div></blockquote>
<p><strong>HTTP Response</strong></p>
<blockquote>
<div><p>An HTTP Response has four major parts:</p>
<ul class="simple">
<li><p><strong>Status/Response Code</strong> − Indicates the Server status for the requested resource. For example, 404 means resource not found and 200 means response is ok.</p></li>
<li><p><strong>HTTP Version</strong> − Indicates the HTTP version. For example HTTP v1.1.</p></li>
<li><p><strong>Response Header</strong> − Contains metadata for the HTTP Response message as keyvalue pairs. For example, content length, content type, response date, server type, etc.</p></li>
<li><p><strong>Response Body</strong> − Response message content or Resource representation.</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<p>Basic request and response messages.</p>
<blockquote>
<div><p><strong>For the request:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Consists of a line that have the method, the path, and the version of HTTP being used.</p></li>
<li><p>An optional header to send extra information, for example the user-agent, the content of the body etc…</p></li>
<li><p>An optional body also can be used to send information depending on the method. For example you cant send any with GET but a POST request usually contains a body having the required information specific to a resource.</p></li>
</ul>
</div></blockquote>
<p><strong>For a response:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Again the version, also there is a status code stating the result of the request (200 for a success, 404 not found, etc… error codes are grouped by the nature of the error, for example 5xx is about server side errors. 4xx client errors, 2xx successful, 1xx informational) and a status message. Also, the header and the body are optional.</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt><strong>Addressing(URI):</strong></dt><dd><ul class="simple">
<li><p>Addressing refers to locating a resource or multiple resources lying on the server.</p></li>
<li><p>Each resource in ARA::REST architecture is identified by its URI (Uniform Resource Identifier). A URI is of the following format:
- “&lt;protocol&gt;://&lt;service-name&gt;/&lt;ResourceType&gt;/&lt;ResourceID&gt;”</p></li>
<li><p>Purpose of an URI is to locate a resource(s) on the server hosting the web service.</p></li>
<li><p>Another important attribute of a request is VERB which identifies the operation to be performed on the resource.</p></li>
</ul>
</dd>
</dl>
<p>There are 4 parts in a URL:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Protocol:</strong> The application-level protocol used by the client and server, e.g., HTTP, FTP, and telnet.</p></li>
<li><p><strong>Hostname:</strong> The DNS domain name (e.g., www.nowhere123.com) or IP address (e.g., 192.128.1.2) of the server.</p></li>
<li><p><strong>Port:</strong> The TCP port number that the server is listening for incoming requests from the clients.</p></li>
<li><p><strong>Path-and-file-name:</strong> The name and location of the requested resource, under the server document base directory.</p></li>
</ul>
</div></blockquote>
<dl>
<dt><strong>Object graph model:</strong></dt><dd><ul class="simple">
<li><p>ara::rest communicates via tree-structured data called object graphs.</p></li>
<li><p>OGM is a syntax tree of a “struct”; shall be able to map struct as well as JSON.</p></li>
<li><p>It provides all necessary abstractions to build, traverse and dissect object graphs at C++ level.</p></li>
<li><p>It reflects the capabilities of JSON to some extent for easy serialization.</p></li>
<li><p>JSON is map–based, which makes it easy to divide a large data set into smaller subsets and send them across the wire on demand.</p></li>
<li><p>JSON Graph allows a graph to be modeled as JSON without introducing duplicates. Instead of inserting an entity into the same message multiple times, each entity with a unique identifier is inserted into a single, globally unique location in the JSON Graph object.</p></li>
<li><p>The Path to the only location within the JSON Graph object where an entity is stored is referred to as the entity’s Identity Path.</p></li>
<li><p>No two entities in an application’s domain model should have the same Identity Path.</p></li>
<li><p>So identity can be used in URI to browse through different node to GET the status of node element.</p></li>
</ul>
<figure class="align-center" id="id62">
<img alt="../_images/Object_Graph_Model.png" class="with-border" src="../_images/Object_Graph_Model.png" />
<figcaption>
<p><span class="caption-text"><strong>Object Graph Model</strong></span><a class="headerlink" href="#id62" title="Link to this image"></a></p>
</figcaption>
</figure>
</dd>
</dl>
</section>
<section id="use-cases-door-ecu">
<h2><span class="section-number">4.13. </span>Use cases: Door ECU<a class="headerlink" href="#use-cases-door-ecu" title="Link to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p>Each Door has a similar but varying set of controls and actors.</p></li>
<li><p>Door ECU can be expressed as RESTful service.</p></li>
<li><p>Resource doorStatus always has one element (“leaf”).</p></li>
<li><p>Resource windowStatus has 0..1 elements (e.g., manual window).</p></li>
<li><p>Resource controls elements for windows and mirrors.</p></li>
<li><p>Door ECU becomes the ARA::REST server with Driver Door and Rear Door are two nodes each of them having different elements like doorstate, windowstatus and control etc.</p></li>
</ul>
</div></blockquote>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Driver Door:</p></th>
<th class="head"><p>Rear Door:</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Open/Close State</p></td>
<td><p>Open/Close State</p></td>
</tr>
<tr class="row-odd"><td><p>Lock/Unlock State</p></td>
<td><p>Lock/Unlock State</p></td>
</tr>
<tr class="row-even"><td><p>Handle pulled State</p></td>
<td><p>Handle pulled State</p></td>
</tr>
<tr class="row-odd"><td><p>Electric Window</p></td>
<td><p>Electric Window</p></td>
</tr>
<tr class="row-even"><td><p>Control for four windows</p></td>
<td><p>Control for four windows</p></td>
</tr>
</tbody>
</table>
<p>Restful Service model</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Driver Door:</p></th>
<th class="head"><p>Rear Door:</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>/doorFL/doorState/leaf/open ={true, false}</p></td>
<td><p>/doorRR/doorState/leaf/open ={true, false}</p></td>
</tr>
<tr class="row-odd"><td><p>/doorFL/doorState/leaf/locked ={true, false}</p></td>
<td><p>/doorRR/doorState/leaf/locked = {true, false}</p></td>
</tr>
<tr class="row-even"><td><p>/doorFL/doorState/leaf/handlePulled= {true, false}</p></td>
<td><p>/doorRR/doorState/leaf/handlePulled = {true, false}</p></td>
</tr>
<tr class="row-odd"><td><p>/doorFL/windowStatus/window/opened = [0…100%]</p></td>
<td><p>/doorRR/windowStatus/window/opened = [0…100%]</p></td>
</tr>
<tr class="row-even"><td><p>/doorFL/controls/window[1-4] ={fullUp, up, keep, down, fullDown}</p></td>
<td><p>/doorRR/controls/4 ={fullUp, up, keep, down, fullDown}</p></td>
</tr>
</tbody>
</table>
<p>Any web browser or application can become a client and with proper authorization can access the server database (object graph model) and use these RESTful service model in URI to (GET, DELETE, POST , LIST) status of each node element as required .</p>
<p>URI to access Doorstate/leaf will be - <a class="reference external" href="http://example.com/get//doorFL/doorState/leaf/locked">http://example.com/get//doorFL/doorState/leaf/locked</a>, this link will give you the status of the leaf whether it open or closed.</p>
</section>
<section id="poco-library">
<h2><span class="section-number">4.14. </span>POCO Library<a class="headerlink" href="#poco-library" title="Link to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p>REST works over http protocol and ARA::REST uses POCO libraries to implement the HTTP protocol.</p></li>
<li><p>The POCO C++ Libraries are a collection of open source C++ class libraries that simplify and accelerate the development of network-centric, portable applications in C++.</p></li>
<li><p>POCO consists of four core libraries, and a number of add-on libraries. The core libraries are Foundation, XML, Util and Net. Two of the add-on libraries are NetSSL, providing SSL support for the network classes in the Net library, and Data.</p></li>
<li><p>POCO’s Net library makes it easy to write network-based applications.</p></li>
<li><p>No matter whether your application simply needs to send data over a plain TCP socket, or whether your application needs a full-fledged built-in HTTP server.</p></li>
<li><p>At the lowest level, the Net library contains socket classes, supporting TCP stream and server sockets, UDP sockets, multicast sockets, ICMP and raw sockets.</p></li>
<li><p>If your application needs secure sockets, these are available in the NetSSL library, implemented using OpenSSL.</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id63">
<img alt="../_images/POCO_library_component.png" class="with-border" src="../_images/POCO_library_component.png" />
<figcaption>
<p><span class="caption-text"><strong>POCO library component</strong></span><a class="headerlink" href="#id63" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The five core component libraries cover the following areas that can be found in the basic edition:</p>
<blockquote>
<div><p><strong>Foundation</strong>:</p>
<ul class="simple">
<li><p><strong>Platform abstraction</strong> – Eases porting issues of fundamental types, etc.</p></li>
<li><p><strong>Memory management</strong> – Resource Acquisition Is Initialization (RAII), auto_ptr, reference counting garbage collection, etc.</p></li>
<li><p>String utilities.</p></li>
<li><p><strong>Error handling</strong> – Extended exception classes.</p></li>
<li><p><strong>streams</strong> – Encoding and decoding and filtering support.</p></li>
<li><p><strong>threads</strong> – Concurrent processing support.</p></li>
<li><p><strong>Date and time</strong> – Date and time support including formatting and high precision timers</p></li>
<li><p><strong>File system</strong> – Abstracted file system support.</p></li>
<li><p><strong>Logging</strong> – Application and system logging, filtering and logging strategies.</p></li>
<li><p><strong>Processes</strong> – Interprocess communication and memory sharing.</p></li>
<li><p><strong>shared libraries</strong> – Dynamic library support.</p></li>
<li><p><strong>Notifications</strong> – Abstracted notification support.</p></li>
<li><p><strong>Events</strong> – Abstracted event support and strategies.</p></li>
<li><p><strong>Crypt</strong> – Random number generation, Digests and encoding/decoding engines.</p></li>
<li><p><strong>Text</strong> – Unicode encoding support.</p></li>
<li><p><strong>Regular expressions</strong> – Based on Perl compatible regular expression.</p></li>
<li><p><strong>URI</strong> – Universal Resource Identifier support.</p></li>
<li><p><strong>UUID</strong> – Universally Unique Identifiers support and generators.</p></li>
<li><p><strong>Cache support</strong> – Abstracted strategy support.</p></li>
</ul>
<p><strong>Net</strong>:</p>
<ul class="simple">
<li><p><strong>sockets</strong> – Abstracted low level network support.</p></li>
<li><p><strong>Reactor pattern</strong> – Popular network abstraction pattern support.</p></li>
<li><p><strong>MIME messages</strong> – Encoding support.</p></li>
<li><p><strong>HTTP</strong> – High level HTTP support for client and servers.</p></li>
<li><p><strong>FTP</strong> – High level FTP support.</p></li>
<li><p><strong>Mail</strong> – POP3, SMTP stream based support.</p></li>
<li><p><strong>HTML</strong> – Form support.</p></li>
</ul>
<p><strong>XML:</strong></p>
<ul class="simple">
<li><p>Document Object Model (DOM)</p></li>
<li><p>XML writer</p></li>
</ul>
<p><strong>JSON:</strong></p>
<ul class="simple">
<li><p>APIs for reading and writing JSON</p></li>
</ul>
<p><strong>Util:</strong></p>
<ul class="simple">
<li><p>Configuration files</p></li>
<li><p>Command line options</p></li>
<li><p>Tools and server application framework</p></li>
</ul>
</div></blockquote>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../introduction/fc_overview.html" class="btn btn-neutral float-left" title="3. Overview of Function Clusters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tsync/tsync.html" class="btn btn-neutral float-right" title="5. Time Synchronization (TSync)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, AVIN Systems Private Limited.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>