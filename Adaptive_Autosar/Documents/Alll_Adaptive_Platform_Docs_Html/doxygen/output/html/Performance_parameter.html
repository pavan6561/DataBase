<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Adaptive Platform Demonstrator: Performance Parameter</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Adaptive Platform Demonstrator
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('Performance_parameter.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Performance Parameter </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>1) Steps to check communication latency</h2>
<ol type="1">
<li>Communication latency Measurement between two machines could be possible only when , both the machines are synchronize to same time.</li>
<li>We need to install NTP client on both the machines, to synchronize the time between machines.</li>
<li>Below link is used to install and configure NTP server. We also mentioned steps to install NTP server on host machine. <br />
 <a href="http://www.ubuntugeek.com/install-and-configure-network-time-protocol-ntp-serverclients-on-ubuntu-16-04-server.html" target="_blank">http://www.ubuntugeek.com/install-and-configure-network-time-protocol-ntp-serverclients-on-ubuntu-16-04-server.html </a></li>
<li>We also need to have a host machine which has NTP server installed on it. Below is the command to install NTP server on host. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo apt-get install ntp</div></div><!-- fragment --></li>
<li>On the host machine in /etc/ntp.conf file add the below line. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;restrict 192.168.0.0 mask 255.255.255.0 nomodify notrap</div></div><!-- fragment --></li>
<li>Image <div class="image">
<img src="ntpi.png" alt="ntpi.png"/>
<div class="caption">
ntp.conf file on host machine</div></div>
</li>
<li>Use the below command to start the ntp server. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;/etc/init.d/ntp start</div></div><!-- fragment --></li>
<li>Add the meta-networking layer in bblayer.conf as it contains .bb file regarding NTP. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;bitbake-layers add-layer ../yocto-layers/meta-networking</div></div><!-- fragment --></li>
<li>Add the following NTP image using IMAGE_INSTALL in recipe yocto-layers/meta-ara/recipes-core/core-performance-use-case/core-image-apd-minimal-perform-avin.bb <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;IMAGE_INSTALL += &quot;\</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        .. \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        .. \</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        ntp \</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        &quot;</div></div><!-- fragment --></li>
<li>Bitbake respective images. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ bitbake core-image-apd-minimal-perform-ecu1</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ bitbake core-image-apd-minimal-perform-ecu2</div></div><!-- fragment --></li>
<li>After bitbake, flash the image into SDcard.<ol type="a">
<li>We can assign static IP address to target in /etc/network/interface file. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;auto eth0</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;iface eth0 inet static</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;      address 192.168.20.53</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;      netmask 255.255.255.0</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;      network 192.168.20.0</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;      gateway 192.168.20.1</div></div><!-- fragment --></li>
</ol>
</li>
<li><p class="startli">After logged in into the board , the /etc/ntp.conf file on the board should have IP address of host machine in the below format.</p>
<p class="startli">For Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ server &lt;ip adress of host machine&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ fudge &lt;ip adress of host machine&gt; stratum 14</div></div><!-- fragment --></li>
<li>Now restart the respective boards.</li>
<li>Use the below command to check whether both the machines have same time. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;date -u</div></div><!-- fragment --></li>
<li>If both the machines are synchronized to the same host machine, then adjust() method can be used to calculate the communication latency.</li>
<li><b> In the Performance Parameter Sample Application, Adjust() method of Radar and Fusion is used. </b><ul>
<li>In Fusion Application, print timestamp before Adjust() method is being invoked. <div class="image">
<img src="1.png" alt="1.png"/>
<div class="caption">
Fusion Application</div></div>
</li>
<li>Pass this timestamp to Adjust() method in Radar. <div class="image">
<img src="8.png" alt="8.png"/>
<div class="caption">
Radar Application</div></div>
</li>
<li>In Radar Application, print timestamp inside Adjust() method. <div class="image">
<img src="6.png" alt="6.png"/>
<div class="caption">
Radar Application</div></div>
</li>
<li>Check the difference between current time taken in Radar Application and time which was passed as parameter from Fusion.</li>
<li>The difference between the two timestamps specifies the communication latency. <div class="image">
<img src="9.png" alt="9.png"/>
<div class="caption">
Radar Application</div></div>
</li>
</ul>
</li>
<li><b> Now we will do the above method in reverse order from Radar to Fusion </b><ul>
<li>In Radar Application, print timestamp in Adjust() method. <div class="image">
<img src="6.png" alt="6.png"/>
<div class="caption">
Radar Application</div></div>
</li>
<li>Return this timestamp as out parameter of Adjust() method to Fusion. <div class="image">
<img src="2.png" alt="2.png"/>
<div class="caption">
Fusion Application</div></div>
</li>
<li>In Fusion Application, print the timestamp. <div class="image">
<img src="3.png" alt="3.png"/>
<div class="caption">
Fusion Application</div></div>
</li>
<li>Check the difference between current time taken in Fusion Application and the timestamp received from Radar.</li>
<li>The difference between the two timestamps specifies the communication latency. <div class="image">
<img src="4.png" alt="4.png"/>
<div class="caption">
Fusion Application</div></div>
</li>
</ul>
</li>
<li>The above steps illustrates the communication latency between two machines.</li>
</ol>
<h2>2) Steps to check booting time</h2>
<blockquote class="doxtable">
<p><b>2.1 : NXP S32v234SBC</b> </p>
</blockquote>
<ol type="1">
<li>Add the below command into build_s32v234sbc/conf/local.conf file. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;DISTRO_FEATURES +=&quot; ${DISTRO_FEATURES_LIBC} systemd &quot;</div></div><!-- fragment --></li>
<li>Add the following systemd image using IMAGE_INSTALL in recipe yocto-layers/meta-ara/recipes-core/core-per-use-case/core-image-apd-minimal-per.bb <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;IMAGE_INSTALL += &quot;\</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        .. \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        systemd \</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        systemd-analyze \</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        &quot;</div></div><!-- fragment --></li>
<li>Bitbake respective image. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ bitbake core-image-apd-minimal-per</div></div><!-- fragment --></li>
<li>After bitbake, flash the image into SDcard.</li>
<li>Following are the steps to copy image from host system to memory card: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd /tmp/deploy/images/s32v234sbc</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;sudo dd if=image-name.rootfs.sdcard of=/dev/mmcblk0 bs=1M &amp;&amp; sync</div></div><!-- fragment --></li>
<li>When you login into board, Enter the below command to check the booting time. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;systemd-analyze</div></div><!-- fragment --></li>
<li>Enter the below command to store the booting time into .svg image file, which gets stored at /home/root/ directory. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;systemd-analyze plot &gt; filename.svg</div></div><!-- fragment --></li>
<li>Copy the .svg image file into /opt folder. <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cp filename.svg opt/</div></div><!-- fragment --></li>
<li>Now insert the SDCard from board into host machine, /opt directory will conatin filename.svg image file.</li>
<li><p class="startli">This .svg file will contain details regarding booting time.</p>
<div class="image">
<img src="nxpsystemd.svg" alt="nxpsystemd.svg"/>
<div class="caption">
Boot Chart output for NXP</div></div>
<ol type="a">
<li>While a system is booted up by starting the Kernel , systemd initializes the system, starting all the system services.<ul>
<li>multi-user.target : It starts every service that are expected to run in multi user mode.</li>
<li>sysinit.target : systemd starts system initialization services. This includes swap devices enabling and file systems mounting.</li>
<li>basic.target : Starts the basic services like firewalld and microcode services.</li>
<li>local-fs.target : No user related services are started by this target unit. It handles core level services only. This target is one performing actions on basis of /etc/fstab/ and /etc/inittab files.</li>
<li>When systemd starts up the system, it will activate all units that are dependencies of default.target (as well as recursively all dependencies of these dependencies). Usually, default.target is simply an alias of graphical.target or multi-user.target, depending on whether the system is configured for a graphical UI or only for a text console.</li>
<li>Each target has a set of dependencies described in its configuration file. systemd starts the required dependencies. These dependencies are the services required to run the Linux host at a specific level of functionality. When all of the dependencies listed in the target configuration files are loaded and running, the system is running at that target level.</li>
<li>A unit configuration file whose name ends in ".slice" encodes information about a slice unit. A slice unit is a concept for hierarchically managing resources of a group of processes. This management is performed by creating a node in the Linux Control Group (cgroup) tree. Units that manage processes (primarily scope and service units) may be assigned to a specific slice. For each slice, certain resource limits may be set that apply to all processes of all units contained in that slice.</li>
<li>By default, service and scope units are placed in system.slice, virtual machines and containers registered with systemd-machined are found in machine.slice, and user sessions handled by systemd-logind in user.slice. systemd.unit for the common options of all unit configuration files. </li>
</ul>
</li>
</ol>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<style>
  .column {
    float: left;
    width: 50%;
    text-align:right
  } 
  .column1 {
    float: right;
    width: 50%;
    text-align:center;
  }
  .row:after {
    content: "";
    display: table;
    clear: both;
  }
  .row{
    background-color: #f4f0ff;
  }
</style>
<div class="row">
  <div class="column">AVIN Systems Private Limited</div>
  <div class="column1">Version 1.0.1</div>
</div>
